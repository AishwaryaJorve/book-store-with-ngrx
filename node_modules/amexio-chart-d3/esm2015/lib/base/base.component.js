/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Input, Output, EventEmitter } from "@angular/core";
export class AmexioD3BaseChartComponent {
    /**
     * @param {?} charttype
     */
    constructor(charttype) {
        this.onLegendClick = new EventEmitter();
        this.onChartClick = new EventEmitter();
        this.onLineClick = new EventEmitter();
        this.drillableEvent = new EventEmitter();
        this.data = [];
        this.legend = true;
        this.height = "300";
        this.width = "300";
        this.title = "";
        this.labelcolor = "black";
        this.labelflag = false;
        this.level = 0;
        this.drillabledatakey = [];
        this.hScale = true;
        this.vScale = false;
        this.resizeflag = false;
        //-------------------
        this.drillableFlag = true;
        this.possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcddefghijklmonpqrstuvwxyz";
        this.colorIndex = 0;
        this.colors = [];
        this.charttype = charttype;
        this.predefinedcolors = ["#3366cc", "#dc3912", "#ff9900", "#109618", "#990099", "#0099c6", "#dd4477", "#66aa00", "#b82e2e", "#316395", "#994499", "#22aa99", "#aaaa11", "#6633cc", "#e67300", "#8b0707", "#651067", "#329262", "#5574a6", "#3b3eac"];
        this.componentId = this.charttype + "-" + this.generateId();
    }
    /**
     * @protected
     * @return {?}
     */
    initializeData() {
        this.data.forEach((/**
         * @param {?} element
         * @return {?}
         */
        element => {
            element.color = this.getColor(element);
        }));
    }
    /**
     * @protected
     * @param {?} data
     * @param {?} drillablekeys
     * @return {?}
     */
    getMultipleDrillbleKeyData(data, drillablekeys) {
        /** @type {?} */
        let nodeObject = {};
        if (data) {
            for (let index = 0; index < drillablekeys.length; index++) {
                /** @type {?} */
                let element = drillablekeys[index];
                for (let [key, value] of Object.entries(data)) {
                    if (key == element) {
                        nodeObject[key] = value;
                    }
                }
                ;
            }
            return nodeObject;
        }
    }
    /**
     * @private
     * @return {?}
     */
    generateId() {
        /** @type {?} */
        let id = "";
        for (let i = 0; i < 5; i++) {
            id = id + this.possible
                .charAt(Math.floor(Math.random() * this.possible.length));
        }
        id = id + "-" + new Date().getTime();
        return id;
    }
    /**
     * @private
     * @param {?} object
     * @return {?}
     */
    getColor(object) {
        if (object.color) {
            return object.color;
        }
        else if (this.colors.length > this.colorIndex) {
            /** @type {?} */
            const color = this.colors[this.colorIndex];
            this.colorIndex++;
            return color;
        }
        else if ((this.colors.length > 0) && (this.colors.length <= this.colorIndex)) {
            this.colorIndex = 0;
            /** @type {?} */
            const color = this.colors[this.colorIndex];
            return color;
        }
        else {
            /** @type {?} */
            const color = this.predefinedcolors[this.colorIndex];
            this.colorIndex++;
            return color;
        }
    }
    /**
     * @param {?} node
     * @return {?}
     */
    legendClick(node) {
        this.onLegendClick.emit(node);
    }
    /**
     * @param {?} node
     * @return {?}
     */
    chartClick(node) {
        this.onChartClick.emit(node);
    }
    /**
     * @param {?} node
     * @return {?}
     */
    comboLineClick(node) {
        this.onLineClick.emit(node);
    }
    /**
     * @param {?} ref
     * @param {?} node
     * @param {?} event
     * @return {?}
     */
    fordrillableClick(ref, node, event) {
        this.drillableEvent.emit({ ref: ref, node: node, event: event });
    }
    /**
     * @protected
     * @param {?} d3
     * @return {?}
     */
    toolTip(d3) {
        return d3.select("body")
            .append("div")
            .attr('id', 'tooltipid')
            .attr('class', 'amexiod3tooltip')
            .style("position", "absolute")
            .style("z-index", "10")
            .style("fill", "black")
            .style("visibility", "hidden");
    }
    /**
     * @protected
     * @param {?} tooltipdata
     * @return {?}
     */
    toolTipContent(tooltipdata) {
        /** @type {?} */
        let tooltiphtml = "<table>";
        for (const key in tooltipdata) {
            if (tooltipdata.hasOwnProperty(key)) {
                /** @type {?} */
                const value = tooltipdata[key];
                tooltiphtml = tooltiphtml + "<tr>";
                //------------------
                //   tooltiphtml = tooltiphtml + "<td>";
                //   tooltiphtml = tooltiphtml + key+':';
                //   tooltiphtml = tooltiphtml + "</td>";
                //------------------
                tooltiphtml = tooltiphtml + "<td>";
                tooltiphtml = tooltiphtml + value;
                tooltiphtml = tooltiphtml + "</td>";
                tooltiphtml = tooltiphtml + "</tr>";
            }
        }
        tooltiphtml = tooltiphtml + "</table>";
        return tooltiphtml;
    }
    /**
     * @protected
     * @param {?} legend
     * @param {?} xaxis
     * @param {?} yaxis
     * @return {?}
     */
    toolTipWithLegendandAxis(legend, xaxis, yaxis) {
        /** @type {?} */
        let tooltiphtml = "<div>";
        tooltiphtml = tooltiphtml + "<b>" + xaxis + "</b>, ";
        tooltiphtml = tooltiphtml + legend + "</b> ";
        tooltiphtml = tooltiphtml + "<b>" + yaxis + "</b> ";
        tooltiphtml = tooltiphtml + "</div>";
        return tooltiphtml;
    }
    /**
     * @protected
     * @param {?} tooltipData
     * @return {?}
     */
    toolTipForBar(tooltipData) {
        /** @type {?} */
        let tooltiphtml = "<div>";
        for (let [key, value] of Object.entries(tooltipData)) {
            /** @type {?} */
            let sideStyle = "float:left";
            tooltiphtml = tooltiphtml + "<div>";
            tooltiphtml = tooltiphtml + "<span style =" + sideStyle + " ><b>" + key + " " + "</b>" + value + "</br></span>";
            tooltiphtml = tooltiphtml + "</div>";
        }
        return tooltiphtml;
    }
}
AmexioD3BaseChartComponent.propDecorators = {
    onLegendClick: [{ type: Output }],
    onChartClick: [{ type: Output }],
    onLineClick: [{ type: Output }],
    drillableEvent: [{ type: Output }],
    data: [{ type: Input, args: ['data',] }],
    httpurl: [{ type: Input, args: ['http-url',] }],
    httpmethod: [{ type: Input, args: ['http-method',] }],
    legend: [{ type: Input, args: ['legend',] }],
    colors: [{ type: Input, args: ['color',] }],
    height: [{ type: Input, args: ['height',] }],
    width: [{ type: Input, args: ['width',] }],
    title: [{ type: Input, args: ['title',] }],
    labelcolor: [{ type: Input, args: ['label-color',] }],
    labelflag: [{ type: Input, args: ['label',] }],
    datareader: [{ type: Input, args: ['data-reader',] }],
    level: [{ type: Input, args: ['level',] }],
    target: [{ type: Input, args: ['target',] }],
    drillabledatakey: [{ type: Input, args: ['drillable-data',] }],
    hScale: [{ type: Input, args: ['horizontal-scale',] }],
    vScale: [{ type: Input, args: ['vertical-scale',] }]
};
if (false) {
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.onLegendClick;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.onChartClick;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.onLineClick;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.drillableEvent;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.data;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.httpurl;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.httpmethod;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.legend;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.colors;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.height;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.width;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.title;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.labelcolor;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.labelflag;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.datareader;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.level;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.target;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.drillabledatakey;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.hScale;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.vScale;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.resizeflag;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.drillableFlag;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.predefinedcolors;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.componentId;
    /**
     * @type {?}
     * @private
     */
    AmexioD3BaseChartComponent.prototype.possible;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.colorIndex;
    /** @type {?} */
    AmexioD3BaseChartComponent.prototype.charttype;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9hbWV4aW8tY2hhcnQtZDMvIiwic291cmNlcyI6WyJsaWIvYmFzZS9iYXNlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLEVBQUUsWUFBWSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTVELE1BQU07Ozs7SUFzREYsWUFBWSxTQUFnQjtRQXBEbEIsa0JBQWEsR0FBUSxJQUFJLFlBQVksRUFBTyxDQUFDO1FBRTdDLGlCQUFZLEdBQVEsSUFBSSxZQUFZLEVBQU8sQ0FBQztRQUU1QyxnQkFBVyxHQUFRLElBQUksWUFBWSxFQUFPLENBQUM7UUFFM0MsbUJBQWMsR0FBRyxJQUFJLFlBQVksRUFBRSxDQUFDO1FBRS9CLFNBQUksR0FBUSxFQUFFLENBQUM7UUFNYixXQUFNLEdBQVksSUFBSSxDQUFFO1FBSXhCLFdBQU0sR0FBUSxLQUFLLENBQUM7UUFFckIsVUFBSyxHQUFTLEtBQUssQ0FBQztRQUVwQixVQUFLLEdBQVEsRUFBRSxDQUFDO1FBRVYsZUFBVSxHQUFXLE9BQU8sQ0FBQztRQUVuQyxjQUFTLEdBQVksS0FBSyxDQUFDO1FBSTNCLFVBQUssR0FBVyxDQUFDLENBQUM7UUFFVCxxQkFBZ0IsR0FBVSxFQUFFLENBQUM7UUFDM0IsV0FBTSxHQUFZLElBQUksQ0FBQztRQUN2QixXQUFNLEdBQWEsS0FBSyxDQUFDO1FBRXBELGVBQVUsR0FBWSxLQUFLLENBQUM7UUFDNUIscUJBQXFCO1FBRXJCLGtCQUFhLEdBQVksSUFBSSxDQUFDO1FBT3JCLGFBQVEsR0FBWSx1REFBdUQsQ0FBQztRQUVyRixlQUFVLEdBQVcsQ0FBQyxDQUFDO1FBS25CLElBQUksQ0FBQyxNQUFNLEdBQUcsRUFBRSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxTQUFTLEdBQUcsU0FBUyxDQUFDO1FBQzNCLElBQUksQ0FBQyxnQkFBZ0IsR0FBRyxDQUFDLFNBQVMs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QkFBa0I7cUJBQ3hCLEtBQUssU0FBQyxnQkFBZ0I7Ozs7SUFsQ3ZCLG1EQUF1RDs7SUFFdkQsa0RBQXNEOztJQUV0RCxpREFBcUQ7O0lBRXJELG9EQUE4Qzs7SUFFOUMsMENBQThCOztJQUU5Qiw2Q0FBZ0M7O0lBRWhDLGdEQUFzQzs7SUFFdEMsNENBQXlDOztJQUV6Qyw0Q0FBNEI7O0lBRTVCLDRDQUFxQzs7SUFFckMsMkNBQW9DOztJQUVwQywyQ0FBZ0M7O0lBRWhDLGdEQUFtRDs7SUFFbkQsK0NBQTJDOztJQUczQyxnREFBeUM7O0lBQ3pDLDJDQUFrQzs7SUFDbEMsNENBQWdDOztJQUNoQyxzREFBc0Q7O0lBQ3RELDRDQUFrRDs7SUFDbEQsNENBQW9EOztJQUVwRCxnREFBNEI7O0lBRzVCLG1EQUE4Qjs7SUFHOUIsc0RBQTJCOztJQUUzQixpREFBcUI7Ozs7O0lBRXJCLDhDQUFxRjs7SUFFckYsZ0RBQXVCOztJQUV2QiwrQ0FBbUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbnB1dCwgT3V0cHV0LCBFdmVudEVtaXR0ZXIgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuXG5leHBvcnQgY2xhc3MgQW1leGlvRDNCYXNlQ2hhcnRDb21wb25lbnR7XG5cbiAgICBAT3V0cHV0KCkgb25MZWdlbmRDbGljazogYW55ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgICBAT3V0cHV0KCkgb25DaGFydENsaWNrOiBhbnkgPSBuZXcgRXZlbnRFbWl0dGVyPGFueT4oKTtcblxuICAgIEBPdXRwdXQoKSBvbkxpbmVDbGljazogYW55ID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG4gICBcbiAgICBAT3V0cHV0KCkgZHJpbGxhYmxlRXZlbnQgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gICAgXG4gICAgQElucHV0KCdkYXRhJykgZGF0YTogYW55ID0gW107XG5cbiAgICBASW5wdXQoJ2h0dHAtdXJsJykgaHR0cHVybDogYW55O1xuICAgIFxuICAgIEBJbnB1dCgnaHR0cC1tZXRob2QnKSBodHRwbWV0aG9kOiBhbnk7XG5cbiAgICBASW5wdXQoJ2xlZ2VuZCcpIGxlZ2VuZDogYm9vbGVhbiA9IHRydWUgO1xuXG4gICAgQElucHV0KCdjb2xvcicpIGNvbG9yczogYW55O1xuXG4gICAgQElucHV0KCdoZWlnaHQnKSBoZWlnaHQ6IGFueSA9IFwiMzAwXCI7XG5cbiAgICBASW5wdXQoJ3dpZHRoJykgd2lkdGggOiBhbnkgPSBcIjMwMFwiO1xuXG4gICAgQElucHV0KCd0aXRsZScpIHRpdGxlOiBhbnkgPSBcIlwiO1xuXG4gICAgQElucHV0KCdsYWJlbC1jb2xvcicpIGxhYmVsY29sb3I6IHN0cmluZyA9IFwiYmxhY2tcIjtcblxuICAgIEBJbnB1dCgnbGFiZWwnKSBsYWJlbGZsYWc6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBcbiAgICAvLyAtLS0tLS0tLS0tLS0tLSBhZGRlZCBsYXRlciBvblxuICAgIEBJbnB1dCgnZGF0YS1yZWFkZXInKSBkYXRhcmVhZGVyOiBzdHJpbmc7XG4gICAgQElucHV0KCdsZXZlbCcpIGxldmVsOiBudW1iZXIgPSAwO1xuICAgIEBJbnB1dCgndGFyZ2V0JykgdGFyZ2V0OiBudW1iZXI7XG4gICAgQElucHV0KCdkcmlsbGFibGUtZGF0YScpIGRyaWxsYWJsZWRhdGFrZXk6IGFueVtdID0gW107XG4gICAgQElucHV0KCdob3Jpem9udGFsLXNjYWxlJykgaFNjYWxlOiBib29sZWFuID0gdHJ1ZTsgICBcbiAgICBASW5wdXQoJ3ZlcnRpY2FsLXNjYWxlJykgICB2U2NhbGUgOiBib29sZWFuID0gZmFsc2U7XG5cbiAgICByZXNpemVmbGFnOiBib29sZWFuID0gZmFsc2U7XG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tXG5cbiAgICBkcmlsbGFibGVGbGFnOiBib29sZWFuID0gdHJ1ZTtcblxuXG4gICAgcHJlZGVmaW5lZGNvbG9yczogc3RyaW5nW107XG4gICAgXG4gICAgY29tcG9uZW50SWQgOiBzdHJpbmc7XG5cbiAgICBwcml2YXRlICBwb3NzaWJsZSA6IHN0cmluZyA9IFwiQUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZGVmZ2hpamtsbW9ucHFyc3R1dnd4eXpcIjtcblxuICAgIGNvbG9ySW5kZXg6IG51bWJlciA9IDA7XG5cbiAgICBjaGFydHR5cGUgOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihjaGFydHR5cGU6c3RyaW5nKSB7XG4gICAgICAgIHRoaXMuY29sb3JzID0gW107XG4gICAgICAgIHRoaXMuY2hhcnR0eXBlID0gY2hhcnR0eXBlO1xuICAgICAgICB0aGlzLnByZWRlZmluZWRjb2xvcnMgPSBbXCIjMzM2NmNjXCIsIFwiI2RjMzkxMlwiLCBcIiNmZjk5MDBcIiwgXCIjMTA5NjE4XCIsIFwiIzk5MDA5OVwiLCBcIiMwMDk5YzZcIiwgXCIjZGQ0NDc3XCIsIFwiIzY2YWEwMFwiLCBcIiNiODJlMmVcIiwgXCIjMzE2Mzk1XCIsIFwiIzk5NDQ5OVwiLCBcIiMyMmFhOTlcIiwgXCIjYWFhYTExXCIsIFwiIzY2MzNjY1wiLCBcIiNlNjczMDBcIiwgXCIjOGIwNzA3XCIsIFwiIzY1MTA2N1wiLCBcIiMzMjkyNjJcIiwgXCIjNTU3NGE2XCIsIFwiIzNiM2VhY1wiXTtcbiAgICAgICAgdGhpcy5jb21wb25lbnRJZCA9IHRoaXMuY2hhcnR0eXBlICArIFwiLVwiICsgdGhpcy5nZW5lcmF0ZUlkKCk7XG4gICAgfVxuICBcbiAgICBwcm90ZWN0ZWQgaW5pdGlhbGl6ZURhdGEoKSB7XG4gICAgICAgIFxuICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuZGF0YS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgIGVsZW1lbnQuY29sb3IgPSB0aGlzLmdldENvbG9yKGVsZW1lbnQpO1xuICAgICAgICAgICB9KTtcbiAgICAgfVxuXG4gICAgICBwcm90ZWN0ZWQgZ2V0TXVsdGlwbGVEcmlsbGJsZUtleURhdGEoZGF0YTphbnksZHJpbGxhYmxla2V5czphbnkpXG4gICAgICB7XG4gICAgICAgXG4gICAgICAgICAgbGV0IG5vZGVPYmplY3Q9e307XG4gICAgICAgICAgaWYoZGF0YSlcbiAgICAgICAgICB7XG4gICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgZHJpbGxhYmxla2V5cy5sZW5ndGg7IGluZGV4KyspIHtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgbGV0IGVsZW1lbnQgPSBkcmlsbGFibGVrZXlzW2luZGV4XTtcbiAgICAgICAgICAgZm9yIChsZXQgW2tleSx2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZGF0YSkpIHtcbiAgICAgICAgICAgICAgICAgICBpZiAoa2V5ID09IGVsZW1lbnQpIFxuICAgICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBub2RlT2JqZWN0W2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgcmV0dXJuIG5vZGVPYmplY3Q7XG4gICAgICAgICAgICB9XG4gICAgICAgXG4gfVxuICAgICBcbiBwcml2YXRlIGdlbmVyYXRlSWQoKXtcbiAgICAgICBsZXQgaWQgPSBcIlwiO1xuICAgICAgIGZvcihsZXQgaSA9IDA7IGk8NTsgaSsrKXtcbiAgICAgICAgaWQgPSBpZCArIHRoaXMucG9zc2libGVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgIC5jaGFyQXQoTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKnRoaXMucG9zc2libGUubGVuZ3RoKSk7XG4gICAgICAgfVxuICAgICAgIGlkID0gaWQgKyBcIi1cIituZXcgRGF0ZSgpLmdldFRpbWUoKTtcbiAgICAgICByZXR1cm4gaWQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSAgZ2V0Q29sb3Iob2JqZWN0IDogYW55KXtcbiAgICAgICAgaWYgKG9iamVjdC5jb2xvcikge1xuICAgICAgICAgICAgcmV0dXJuIG9iamVjdC5jb2xvcjtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICh0aGlzLmNvbG9ycy5sZW5ndGggPiB0aGlzLmNvbG9ySW5kZXgpIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbG9yID0gdGhpcy5jb2xvcnNbdGhpcy5jb2xvckluZGV4XTtcbiAgICAgICAgICAgIHRoaXMuY29sb3JJbmRleCsrO1xuICAgICAgICAgICAgcmV0dXJuIGNvbG9yO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKCh0aGlzLmNvbG9ycy5sZW5ndGggPiAwKSAmJiAodGhpcy5jb2xvcnMubGVuZ3RoIDw9IHRoaXMuY29sb3JJbmRleCkpIHtcbiAgICAgICAgICAgIHRoaXMuY29sb3JJbmRleCA9IDA7XG4gICAgICAgICAgICBjb25zdCBjb2xvciA9IHRoaXMuY29sb3JzW3RoaXMuY29sb3JJbmRleF07XG4gICAgICAgICAgICByZXR1cm4gY29sb3I7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBjb2xvciA9IHRoaXMucHJlZGVmaW5lZGNvbG9yc1t0aGlzLmNvbG9ySW5kZXhdO1xuICAgICAgICAgICAgdGhpcy5jb2xvckluZGV4Kys7XG4gICAgICAgICAgICByZXR1cm4gY29sb3I7XG4gICAgICAgIH1cbiAgICB9XG5cblxuICAgIGxlZ2VuZENsaWNrKG5vZGU6YW55KXtcbiAgICAgICAgdGhpcy5vbkxlZ2VuZENsaWNrLmVtaXQobm9kZSk7XG4gICAgfVxuXG4gICAgY2hhcnRDbGljayhub2RlOmFueSl7XG4gICAgICAgIHRoaXMub25DaGFydENsaWNrLmVtaXQobm9kZSk7XG4gICAgfVxuICAgIFxuICAgIGNvbWJvTGluZUNsaWNrKG5vZGU6IGFueSl7XG4gICAgICAgIHRoaXMub25MaW5lQ2xpY2suZW1pdChub2RlKTtcbiAgICB9XG4gICAgZm9yZHJpbGxhYmxlQ2xpY2socmVmOiBhbnksbm9kZTogYW55LGV2ZW50OiBhbnkpXG4gICAgIHtcbiAgICAgICAgdGhpcy5kcmlsbGFibGVFdmVudC5lbWl0KHtyZWY6IHJlZixub2RlOiBub2RlLGV2ZW50OiBldmVudH0pO1xuICAgIH1cbiAgICBwcm90ZWN0ZWQgdG9vbFRpcCAoZDM6YW55KSA6YW55e1xuICAgICAgIHJldHVybiAgZDMuc2VsZWN0KFwiYm9keVwiKVxuICAgICAgICAgICAgICAgICAgICAgIC5hcHBlbmQoXCJkaXZcIilcbiAgICAgICAgICAgICAgICAgICAgICAuYXR0cignaWQnLCd0b29sdGlwaWQnKVxuICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdjbGFzcycsJ2FtZXhpb2QzdG9vbHRpcCcpXG4gICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKFwicG9zaXRpb25cIiwgXCJhYnNvbHV0ZVwiKVxuICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZShcInotaW5kZXhcIiwgXCIxMFwiKVxuICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZShcImZpbGxcIixcImJsYWNrXCIpXG4gICAgICAgICAgICAgICAgICAgICAgLnN0eWxlKFwidmlzaWJpbGl0eVwiLCBcImhpZGRlblwiKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgdG9vbFRpcENvbnRlbnQodG9vbHRpcGRhdGE6YW55KSA6YW55e1xuICAgICAgIGxldCB0b29sdGlwaHRtbCA9IFwiPHRhYmxlPlwiO1xuICAgICAgZm9yIChjb25zdCBrZXkgaW4gdG9vbHRpcGRhdGEpIHtcbiAgICAgICAgaWYgKHRvb2x0aXBkYXRhLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICBjb25zdCB2YWx1ZSA9IHRvb2x0aXBkYXRhW2tleV07XG4gICAgICAgICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIFwiPHRyPlwiO1xuLy8tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAgICAgLy8gICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsgXCI8dGQ+XCI7XG4gICAgICAgIC8vICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIGtleSsnOic7XG4gICAgICAgIC8vICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIFwiPC90ZD5cIjtcbi8vLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgICAgICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIFwiPHRkPlwiO1xuICAgICAgICAgIHRvb2x0aXBodG1sID0gdG9vbHRpcGh0bWwgKyB2YWx1ZTtcbiAgICAgICAgICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsgXCI8L3RkPlwiO1xuICAgICAgICAgIHRvb2x0aXBodG1sID0gdG9vbHRpcGh0bWwgKyBcIjwvdHI+XCI7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRvb2x0aXBodG1sID0gdG9vbHRpcGh0bWwgKyBcIjwvdGFibGU+XCI7XG5cbiAgICAgIHJldHVybiB0b29sdGlwaHRtbDtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgdG9vbFRpcFdpdGhMZWdlbmRhbmRBeGlzKGxlZ2VuZDogc3RyaW5nLCB4YXhpczpzdHJpbmcsIHlheGlzOiBzdHJpbmcpIDphbnl7XG4gICAgICAgIGxldCB0b29sdGlwaHRtbCA9IFwiPGRpdj5cIjtcbiAgICAgICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIFwiPGI+XCIreGF4aXMrXCI8L2I+LCBcIjtcbiAgICAgICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIGxlZ2VuZCtcIjwvYj4gXCI7XG4gICAgICAgIHRvb2x0aXBodG1sID0gdG9vbHRpcGh0bWwgKyBcIjxiPlwiK3lheGlzK1wiPC9iPiBcIjtcbiAgICAgICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIFwiPC9kaXY+XCI7XG4gICAgICAgIHJldHVybiB0b29sdGlwaHRtbDtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgdG9vbFRpcEZvckJhcih0b29sdGlwRGF0YTogYW55KTogYW55e1xuICAgICAgICAgbGV0IHRvb2x0aXBodG1sPSBcIjxkaXY+XCI7XG4gICAgICAgIGZvciAobGV0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyh0b29sdGlwRGF0YSkpIHtcbiAgICAgICAgICAgIGxldCBzaWRlU3R5bGU9XCJmbG9hdDpsZWZ0XCI7XG4gICAgICAgICAgICB0b29sdGlwaHRtbCA9IHRvb2x0aXBodG1sICsgXCI8ZGl2PlwiO1xuICAgICAgICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIFwiPHNwYW4gc3R5bGUgPVwiK3NpZGVTdHlsZStcIiA+PGI+XCIgKyBrZXkgK1wiIFwiKyBcIjwvYj5cIiArdmFsdWUgKyBcIjwvYnI+PC9zcGFuPlwiO1xuICAgICAgICAgdG9vbHRpcGh0bWwgPSB0b29sdGlwaHRtbCArIFwiPC9kaXY+XCI7XG4gICAgICAgIH1cblxuICAgICAgICAgcmV0dXJuIHRvb2x0aXBodG1sO1xuICAgIH1cblxufSJdfQ==