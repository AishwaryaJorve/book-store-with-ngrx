/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Component, Input, ViewChild, ElementRef, ChangeDetectorRef } from '@angular/core';
import * as d3 from 'd3';
import { AmexioD3BaseChartComponent } from '../base/base.component';
import { CommanDataService } from '../services/comman.data.service';
import { DeviceQueryService } from '../services/device.query.service';
var AmexioD3DounutChartComponent = /** @class */ (function (_super) {
    tslib_1.__extends(AmexioD3DounutChartComponent, _super);
    function AmexioD3DounutChartComponent(myservice, cdf, device) {
        var _this = _super.call(this, 'DONUTCHART') || this;
        _this.myservice = myservice;
        _this.cdf = cdf;
        _this.device = device;
        _this.pie = false;
        _this.svgwidth = 300;
        _this.svgheight = 300;
        _this.desktoplegend = false;
        _this.mobilelegend = false;
        _this.keyArray = [];
        _this.transformeddata = [];
        _this.legendArray = [];
        return _this;
    }
    /**
     * @return {?}
     */
    AmexioD3DounutChartComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        if (this.level <= 1) {
            /** @type {?} */
            var resp_1;
            if (this.httpmethod && this.httpurl) {
                this.myservice.fetchUrlData(this.httpurl, this.httpmethod).subscribe((/**
                 * @param {?} response
                 * @return {?}
                 */
                function (response) {
                    resp_1 = response;
                }), (/**
                 * @param {?} error
                 * @return {?}
                 */
                function (error) {
                }), (/**
                 * @return {?}
                 */
                function () {
                    setTimeout((/**
                     * @return {?}
                     */
                    function () {
                        _this.data = _this.getResponseData(resp_1);
                        _this.drawChart();
                        // this.data = this.getResponseData(resp);
                        _this.transformData(_this.data);
                        _this.initializeData();
                        _this.plotD3Chart();
                    }), 0);
                }));
            }
            else if (this.data) {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.data = _this.getResponseData(_this.data);
                    _this.transformData(_this.data);
                    _this.initializeData();
                    _this.plotD3Chart();
                }), 0);
            }
        }
        else {
            this.fetchData(this.drillData);
        }
    };
    /**
     * @param {?} data
     * @return {?}
     */
    AmexioD3DounutChartComponent.prototype.fetchData = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        /** @type {?} */
        var requestJson;
        /** @type {?} */
        var key = this.drillabledatakey;
        /** @type {?} */
        var resp;
        if (this.drillabledatakey.length) {
            /** @type {?} */
            var drillabledata = this.getMultipleDrillbleKeyData(data, key);
            requestJson = drillabledata;
        }
        else {
            requestJson = data;
        }
        if (this.httpmethod && this.httpurl) {
            this.myservice.postfetchData(this.httpurl, this.httpmethod, requestJson).subscribe((/**
             * @param {?} response
             * @return {?}
             */
            function (response) {
                resp = response;
                _this.response = resp;
            }), (/**
             * @param {?} error
             * @return {?}
             */
            function (error) {
            }), (/**
             * @return {?}
             */
            function () {
                setTimeout((/**
                 * @return {?}
                 */
                function () {
                    _this.data = _this.getResponseData(resp);
                    _this.drawChart();
                }), 0);
            }));
        }
    };
    /**
     * @return {?}
     */
    AmexioD3DounutChartComponent.prototype.drawChart = /**
     * @return {?}
     */
    function () {
        var _this = this;
        setTimeout((/**
         * @return {?}
         */
        function () {
            _this.drillableFlag = true;
            _this.initializeData();
            _this.plotD3Chart();
        }), 0);
    };
    /**
     * @param {?} httpResponse
     * @return {?}
     */
    AmexioD3DounutChartComponent.prototype.getResponseData = /**
     * @param {?} httpResponse
     * @return {?}
     */
    function (httpResponse) {
        /** @type {?} */
        var responsedata = httpResponse;
        if (this.datareader != null) {
            /** @type {?} */
            var dr = this.datareader.split('.');
            try {
                for (var dr_1 = tslib_1.__values(dr), dr_1_1 = dr_1.next(); !dr_1_1.done; dr_1_1 = dr_1.next()) {
                    var ir = dr_1_1.value;
                    responsedata = responsedata[ir];
                }
            }
            catch (e_1_1) { e_1 = { error: e_1_1 }; }
            finally {
                try {
                    if (dr_1_1 && !dr_1_1.done && (_a = dr_1.return)) _a.call(dr_1);
                }
                finally { if (e_1) throw e_1.error; }
            }
        }
        else {
            responsedata = httpResponse;
        }
        return responsedata;
        var e_1, _a;
    };
    /**
     * @return {?}
     */
    AmexioD3DounutChartComponent.prototype.plotD3Chart = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.formLegendData();
        //this.transformData(this.data);
        //  this.data = this.transformeddata;
        /** @type {?} */
        var outerRadius = 0;
        /** @type {?} */
        var innerRadius = 0;
        outerRadius = this.svgwidth / 2;
        innerRadius = this.svgwidth / 4;
        if (this.pie) {
            innerRadius = 0;
        }
        /** @type {?} */
        var tooltip = this.toolTip(d3);
        /** @type {?} */
        var arc = d3.arc()
            .outerRadius(outerRadius)
            .innerRadius(innerRadius);
        /** @type {?} */
        var pie = d3.pie()
            .value((/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            return d[Object.keys(d)[1]];
            //  return d.value
        }));
        this.svg = d3.select("#" + this.componentId)
            .append('g')
            .attr('transform', 'translate(' + this.svgwidth / 2 + ',' + this.svgheight / 2 + ')')
            .selectAll('path')
            .data(pie(this.data))
            .enter();
        if (this.device.IsDesktop() == true) {
            this.desktoplegend = true;
            this.mobilelegend = false;
        }
        // else{
        //        if(this.device.IsPhone()==true && this.device.IsTablet()==true)
        //        {
        //             this.desktoplegend=false;
        //             this.mobilelegend=true;
        //        }
        // }
        /** @type {?} */
        var path = this.svg.append('path')
            .attr('d', arc)
            .attr('fill', (/**
         * @param {?} d
         * @param {?} i
         * @return {?}
         */
        function (d, i) {
            if (d.data.color) {
                return d.data.color;
            }
            else {
                return "black";
            }
            //  return (d && d.data && d.data.color) ? d.data.color : "black"
        }))
            .attr('cursor', 'pointer')
            .on("mouseover", (/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            return tooltip.style("visibility", "visible");
        }))
            .on("mousemove", (/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            return tooltip.html(_this.formTooltipData(d.data)
            //  this.formLegendData(d.data)
            // this.toolTipContent(d.data)
            )
                .style("top", (d3.event.pageY - 10) + "px")
                .style("left", (d3.event.pageX + 10) + "px");
        }))
            .on("mouseout", (/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            return tooltip.style("visibility", "hidden");
        }))
            .on("click", (/**
         * @param {?} d
         * @return {?}
         */
        function (d) {
            _this.DonutChartClick(d.data);
            _this.fordrillableClick(_this, d.data, event);
            return tooltip.style("visibility", "hidden");
            //this.chartClick(d.data);
        }));
        if (this.labelflag) {
            /** @type {?} */
            var text = this.svg.append("text")
                .transition()
                .duration(200)
                .attr("transform", (/**
             * @param {?} d
             * @return {?}
             */
            function (d) {
                return "translate(" + arc.centroid(d) + ")";
            }))
                .attr("text-anchor", "middle")
                .text((/**
             * @param {?} d
             * @return {?}
             */
            function (d) {
                return d.data[Object.keys(d.data)[1]];
                //return d.data.value;
            }))
                .style('fill', (/**
             * @param {?} d
             * @return {?}
             */
            function (d) {
                if (_this.labelcolor && _this.labelcolor.length > 0) {
                    return _this.labelcolor;
                }
                else {
                    return "black";
                }
                // return (d && d.data && d.data.textcolor) ? d.data.textcolor : "black";
            }))
                .style('font-size', '12px');
        }
    };
    /**
     * @return {?}
     */
    AmexioD3DounutChartComponent.prototype.formLegendData = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.legendArray = [];
        this.data.forEach((/**
         * @param {?} element
         * @return {?}
         */
        function (element) {
            /** @type {?} */
            var legendobject = {};
            legendobject['label'] = element[Object.keys(element)[0]];
            legendobject['value'] = element[Object.keys(element)[1]];
            legendobject['color'] = element.color;
            _this.legendArray.push(legendobject);
        }));
    };
    /**
     * @param {?} legendevent
     * @return {?}
     */
    AmexioD3DounutChartComponent.prototype.onDonutLegendClick = /**
     * @param {?} legendevent
     * @return {?}
     */
    function (legendevent) {
        /** @type {?} */
        var obj = {};
        //  obj['label'] = legendevent.label;
        //  obj['value'] = legendevent.value 
        obj[this.keyArray[0]] = legendevent.label;
        obj[this.keyArray[1]] = legendevent.value;
        //delete event.color;
        this.legendClick(obj);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    AmexioD3DounutChartComponent.prototype.transformData = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        var _this = this;
        this.keyArray = data[0];
        data.forEach((/**
         * @param {?} element
         * @param {?} index
         * @return {?}
         */
        function (element, index) {
            if (index > 0) {
                /** @type {?} */
                var DummyObject_1 = {};
                element.forEach((/**
                 * @param {?} individualvalue
                 * @param {?} keyindex
                 * @return {?}
                 */
                function (individualvalue, keyindex) {
                    DummyObject_1[_this.keyArray[keyindex]] = individualvalue;
                })); //inner for loop ends
                _this.transformeddata.push(DummyObject_1);
            } //if ends
        })); //outer for loop ends
        this.data = this.transformeddata;
    };
    /**
     * @param {?} tooltipData
     * @return {?}
     */
    AmexioD3DounutChartComponent.prototype.formTooltipData = /**
     * @param {?} tooltipData
     * @return {?}
     */
    function (tooltipData) {
        /** @type {?} */
        var object = {};
        try {
            for (var _a = tslib_1.__values(Object.entries(tooltipData)), _b = _a.next(); !_b.done; _b = _a.next()) {
                var _c = tslib_1.__read(_b.value, 2), key = _c[0], value = _c[1];
                if (key != 'color' && key != 'textcolor') {
                    object[key] = value;
                }
            }
        }
        catch (e_2_1) { e_2 = { error: e_2_1 }; }
        finally {
            try {
                if (_b && !_b.done && (_d = _a.return)) _d.call(_a);
            }
            finally { if (e_2) throw e_2.error; }
        }
        return this.toolTipForBar(object);
        var e_2, _d;
    };
    /**
     * @param {?} event
     * @return {?}
     */
    AmexioD3DounutChartComponent.prototype.DonutChartClick = /**
     * @param {?} event
     * @return {?}
     */
    function (event) {
        /** @type {?} */
        var object = {};
        try {
            for (var _a = tslib_1.__values(Object.entries(event)), _b = _a.next(); !_b.done; _b = _a.next()) {
                var _c = tslib_1.__read(_b.value, 2), key = _c[0], value = _c[1];
                if (key != 'color') {
                    object[key] = value;
                }
            }
        }
        catch (e_3_1) { e_3 = { error: e_3_1 }; }
        finally {
            try {
                if (_b && !_b.done && (_d = _a.return)) _d.call(_a);
            }
            finally { if (e_3) throw e_3.error; }
        }
        this.chartClick(object);
        var e_3, _d;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    AmexioD3DounutChartComponent.prototype.resize = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.desktoplegend = false;
        this.mobilelegend = true;
        this.plotD3Chart();
    };
    AmexioD3DounutChartComponent.decorators = [
        { type: Component, args: [{
                    selector: 'amexio-d3-chart-donut',
                    template: "<div *ngIf=\"drillableFlag\" #chartId (window:resize)=\"resize($event)\">\n    <div *ngIf=\"data.length > 0\">\n\n  \n    <div colspan=\"2\" style=\"font-size: 18px; font-weight: bold; \">\n        {{title}}\n    </div>\n    <div [ngClass]=\"'donutcss'\">\n        <svg preserveAspectRatio=\"xMinYMin meet\" viewBox=\"0 0 300 300\" [attr.height]=\"height\" [attr.width]=\"width\" [attr.id]=\"componentId\">\n        </svg>\n        <div>\n\n            <div style=\"display: block; padding: 1%;\">\n                <div *ngIf=\"desktoplegend\">\n                    <amexio-d3-legend *ngIf=\"legend\" (onClick)=\"onDonutLegendClick($event)\" [data]=\"legendArray\" style=\"height:100%;\"></amexio-d3-legend>\n                </div>\n                <div *ngIf=\"mobilelegend\">\n                    <amexio-d3-legend *ngIf=\"legend\" [horizontal]=\"true\" (onClick)=\"onDonutLegendClick($event)\" [data]=\"legendArray\" style=\"height:100%;\"></amexio-d3-legend>\n                </div>\n            </div>\n        </div>\n        <!--  -->\n        <div *ngIf=\"data.length < 1\" class=\"lmask\" style=\"padding-top:50%\">\n            </div>\n\n        </div>",
                    styles: [".donutcss{display:flex;flex-direction:row}@media screen and (max-width:1024px){.donutcss{display:flex;flex-direction:column}}"]
                },] },
    ];
    AmexioD3DounutChartComponent.ctorParameters = function () { return [
        { type: CommanDataService },
        { type: ChangeDetectorRef },
        { type: DeviceQueryService }
    ]; };
    AmexioD3DounutChartComponent.propDecorators = {
        pie: [{ type: Input, args: ['pie',] }],
        svgwidth: [{ type: Input, args: ['width',] }],
        svgheight: [{ type: Input, args: ['height',] }],
        chartId: [{ type: ViewChild, args: ['chartId',] }],
        divid: [{ type: ViewChild, args: ['divid',] }],
        drillid: [{ type: ViewChild, args: ['drillid',] }],
        drillData: [{ type: Input }]
    };
    return AmexioD3DounutChartComponent;
}(AmexioD3BaseChartComponent));
export { AmexioD3DounutChartComponent };
if (false) {
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.pie;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.svgwidth;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.svgheight;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.chartId;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.divid;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.drillid;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.desktoplegend;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.mobilelegend;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.drillData;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.keyArray;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.transformeddata;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.legendArray;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.response;
    /** @type {?} */
    AmexioD3DounutChartComponent.prototype.svg;
    /**
     * @type {?}
     * @private
     */
    AmexioD3DounutChartComponent.prototype.myservice;
    /**
     * @type {?}
     * @private
     */
    AmexioD3DounutChartComponent.prototype.cdf;
    /**
     * @type {?}
     * @private
     */
    AmexioD3DounutChartComponent.prototype.device;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZG91bnV0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiJuZzovL2FtZXhpby1jaGFydC1kMy8iLCJzb3VyY2VzIjpbImxpYi9kb3VudXQvZG91bnV0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7OztBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQWdCLEtBQUssRUFBa0IsU0FBUyxFQUFFLFVBQVUsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN6SCxPQUFPLEtBQUssRUFBRSxNQUFNLElBQUksQ0FBQztBQUN6QixPQUFPLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSx3QkFBd0IsQ0FBQztBQUdwRSxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsTUFBTSxpQ0FBaUMsQ0FBQztBQUNwRSxPQUFPLEVBQUUsa0JBQWtCLEVBQUUsTUFBTSxrQ0FBa0MsQ0FBQztBQUV0RTtJQThCa0Qsd0RBQTBCO0lBZ0IxRSxzQ0FBb0IsU0FBNEIsRUFBVSxHQUFzQixFQUFVLE1BQTBCO1FBQXBILFlBQ0Usa0JBQU0sWUFBWSxDQUFDLFNBQ3BCO1FBRm1CLGVBQVMsR0FBVCxTQUFTLENBQW1CO1FBQVUsU0FBRyxHQUFILEdBQUcsQ0FBbUI7UUFBVSxZQUFNLEdBQU4sTUFBTSxDQUFvQjtRQWR0RyxTQUFHLEdBQVksS0FBSyxDQUFDO1FBQ25CLGNBQVEsR0FBVyxHQUFHLENBQUM7UUFDdEIsZUFBUyxHQUFXLEdBQUcsQ0FBQztRQUl6QyxtQkFBYSxHQUFZLEtBQUssQ0FBQztRQUMvQixrQkFBWSxHQUFZLEtBQUssQ0FBQztRQUU5QixjQUFRLEdBQVUsRUFBRSxDQUFDO1FBQ3JCLHFCQUFlLEdBQVUsRUFBRSxDQUFDO1FBQzVCLGlCQUFXLEdBQVUsRUFBRSxDQUFDOztJQUt4QixDQUFDOzs7O0lBRUQsK0NBQVE7OztJQUFSO1FBQUEsaUJBb0NDO1FBbENDLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQzs7Z0JBQ2hCLE1BQVM7WUFDYixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxJQUFJLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO2dCQUNwQyxJQUFJLENBQUMsU0FBUyxDQUFDLFlBQVksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQyxTQUFTOzs7O2dCQUFDLFVBQUMsUUFBUTtvQkFDNUUsTUFBSSxHQUFHLFFBQVEsQ0FBQztnQkFDbEIsQ0FBQzs7OztnQkFBRSxVQUFDLEtBQUs7Z0JBQ1QsQ0FBQzs7O2dCQUFFO29CQUVELFVBQVU7OztvQkFBQzt3QkFDVCxLQUFJLENBQUMsSUFBSSxHQUFHLEtBQUksQ0FBQyxlQUFlLENBQUMsTUFBSSxDQUFDLENBQUM7d0JBQ3ZDLEtBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQzt3QkFFakIsMENBQTBDO3dCQUMxQyxLQUFJLENBQUMsYUFBYSxDQUFDLEtBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQzt3QkFDOUIsS0FBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO3dCQUN0QixLQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7b0JBQ3JCLENBQUMsR0FBRSxDQUFDLENBQUMsQ0FBQztnQkFDUixDQUFDLEVBQUMsQ0FBQztZQUVMLENBQUM7WUFBQyxJQUFJLENBQ0osRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7Z0JBR2QsVUFBVTs7O2dCQUFDO29CQUNULEtBQUksQ0FBQyxJQUFJLEdBQUcsS0FBSSxDQUFDLGVBQWUsQ0FBQyxLQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7b0JBQzVDLEtBQUksQ0FBQyxhQUFhLENBQUMsS0FBSSxDQUFDLElBQUksQ0FBQyxDQUFDO29CQUM5QixLQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7b0JBQ3RCLEtBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztnQkFDckIsQ0FBQyxHQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ1IsQ0FBQztRQUNMLENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUVOLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO1FBQ2pDLENBQUM7SUFDSCxDQUFDOzs7OztJQUdELGdEQUFTOzs7O0lBQVQsVUFBVSxJQUFTO1FBQW5CLGlCQTRCQzs7WUExQkssV0FBVzs7WUFDWCxHQUFHLEdBQUcsSUFBSSxDQUFDLGdCQUFnQjs7WUFDM0IsSUFBUztRQUViLEVBQUUsQ0FBQyxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDOztnQkFDN0IsYUFBYSxHQUFHLElBQUksQ0FBQywwQkFBMEIsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDO1lBQzlELFdBQVcsR0FBRyxhQUFhLENBQUM7UUFDOUIsQ0FBQztRQUNELElBQUksQ0FBQyxDQUFDO1lBQ0osV0FBVyxHQUFHLElBQUksQ0FBQztRQUNyQixDQUFDO1FBRUQsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQztZQUNwQyxJQUFJLENBQUMsU0FBUyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxVQUFVLEVBQUUsV0FBVyxDQUFDLENBQUMsU0FBUzs7OztZQUFDLFVBQUMsUUFBUTtnQkFDMUYsSUFBSSxHQUFHLFFBQVEsQ0FBQztnQkFDaEIsS0FBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7WUFDdkIsQ0FBQzs7OztZQUFFLFVBQUMsS0FBSztZQUNULENBQUM7OztZQUFFO2dCQUNELFVBQVU7OztnQkFBQztvQkFDVCxLQUFJLENBQUMsSUFBSSxHQUFHLEtBQUksQ0FBQyxlQUFlLENBQUMsSUFBSSxDQUFDLENBQUM7b0JBRXZDLEtBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQztnQkFFbkIsQ0FBQyxHQUFFLENBQUMsQ0FBQyxDQUFDO1lBQ1IsQ0FBQyxFQUFDLENBQUM7UUFDTCxDQUFDO0lBQ0gsQ0FBQzs7OztJQUVELGdEQUFTOzs7SUFBVDtRQUFBLGlCQU9DO1FBTkMsVUFBVTs7O1FBQUM7WUFDVCxLQUFJLENBQUMsYUFBYSxHQUFHLElBQUksQ0FBQztZQUMxQixLQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7WUFDdEIsS0FBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO1FBQ3JCLENBQUMsR0FBRSxDQUFDLENBQUMsQ0FBQztJQUVSLENBQUM7Ozs7O0lBRUQsc0RBQWU7Ozs7SUFBZixVQUFnQixZQUFpQjs7WUFDM0IsWUFBWSxHQUFHLFlBQVk7UUFDL0IsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDOztnQkFDdEIsRUFBRSxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQzs7Z0JBQ3JDLEdBQUcsQ0FBQyxDQUFhLElBQUEsT0FBQSxpQkFBQSxFQUFFLENBQUEsc0JBQUE7b0JBQWQsSUFBTSxFQUFFLGVBQUE7b0JBQ1gsWUFBWSxHQUFHLFlBQVksQ0FBQyxFQUFFLENBQUMsQ0FBQztpQkFDakM7Ozs7Ozs7OztRQUNILENBQUM7UUFBQyxJQUFJLENBQUMsQ0FBQztZQUNOLFlBQVksR0FBRyxZQUFZLENBQUM7UUFDOUIsQ0FBQztRQUNELE1BQU0sQ0FBQyxZQUFZLENBQUM7O0lBQ3RCLENBQUM7Ozs7SUFDRCxrREFBVzs7O0lBQVg7UUFBQSxpQkF1R0M7UUF0R0MsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDOzs7O1lBR2xCLFdBQVcsR0FBRyxDQUFDOztZQUNmLFdBQVcsR0FBRyxDQUFDO1FBRW5CLFdBQVcsR0FBRyxJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsQ0FBQztRQUNoQyxXQUFXLEdBQUcsSUFBSSxDQUFDLFFBQVEsR0FBRyxDQUFDLENBQUM7UUFFaEMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7WUFDYixXQUFXLEdBQUcsQ0FBQyxDQUFDO1FBQ2xCLENBQUM7O1lBRUssT0FBTyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDOztZQUUxQixHQUFHLEdBQUcsRUFBRSxDQUFDLEdBQUcsRUFBRTthQUNqQixXQUFXLENBQUMsV0FBVyxDQUFDO2FBQ3hCLFdBQVcsQ0FBQyxXQUFXLENBQUM7O1lBRXJCLEdBQUcsR0FBRyxFQUFFLENBQUMsR0FBRyxFQUFFO2FBQ2pCLEtBQUs7Ozs7UUFBQyxVQUFDLENBQUM7WUFDUCxNQUFNLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUM1QixrQkFBa0I7UUFDcEIsQ0FBQyxFQUFDO1FBRUosSUFBSSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsV0FBVyxDQUFDO2FBQ3pDLE1BQU0sQ0FBQyxHQUFHLENBQUM7YUFDWCxJQUFJLENBQUMsV0FBVyxFQUFFLFlBQVksR0FBRyxJQUFJLENBQUMsUUFBUSxHQUFHLENBQUMsR0FBRyxHQUFHLEdBQUcsSUFBSSxDQUFDLFNBQVMsR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDO2FBQ3BGLFNBQVMsQ0FBQyxNQUFNLENBQUM7YUFDakIsSUFBSSxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7YUFDcEIsS0FBSyxFQUFFLENBQUM7UUFFWCxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsRUFBRSxJQUFJLElBQUksQ0FBQyxDQUFDLENBQUM7WUFDcEMsSUFBSSxDQUFDLGFBQWEsR0FBRyxJQUFJLENBQUM7WUFDMUIsSUFBSSxDQUFDLFlBQVksR0FBRyxLQUFLLENBQUM7UUFDNUIsQ0FBQzs7Ozs7Ozs7O1lBU0ssSUFBSSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQzthQUNqQyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsQ0FBQzthQUNkLElBQUksQ0FBQyxNQUFNOzs7OztRQUFFLFVBQUMsQ0FBQyxFQUFFLENBQUM7WUFDakIsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDO2dCQUNqQixNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7WUFDdEIsQ0FBQztZQUNELElBQUksQ0FBQyxDQUFDO2dCQUNKLE1BQU0sQ0FBQyxPQUFPLENBQUM7WUFDakIsQ0FBQztZQUNELGlFQUFpRTtRQUNuRSxDQUFDLEVBQUM7YUFDRCxJQUFJLENBQUMsUUFBUSxFQUFFLFNBQVMsQ0FBQzthQUN6QixFQUFFLENBQUMsV0FBVzs7OztRQUFFLFVBQUMsQ0FBQztZQUNqQixNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDaEQsQ0FBQyxFQUFDO2FBQ0QsRUFBRSxDQUFDLFdBQVc7Ozs7UUFBRSxVQUFDLENBQUM7WUFDakIsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQ2pCLEtBQUksQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztZQUU1QiwrQkFBK0I7WUFDL0IsOEJBQThCO2FBQy9CO2lCQUNFLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUM7aUJBQzFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQztRQUNqRCxDQUFDLEVBQUM7YUFDRCxFQUFFLENBQUMsVUFBVTs7OztRQUFFLFVBQUMsQ0FBQztZQUNoQixNQUFNLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxZQUFZLEVBQUUsUUFBUSxDQUFDLENBQUM7UUFDL0MsQ0FBQyxFQUFDO2FBQ0QsRUFBRSxDQUFDLE9BQU87Ozs7UUFBRSxVQUFDLENBQUM7WUFDYixLQUFJLENBQUMsZUFBZSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUM3QixLQUFJLENBQUMsaUJBQWlCLENBQUMsS0FBSSxFQUFFLENBQUMsQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7WUFDNUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsWUFBWSxFQUFFLFFBQVEsQ0FBQyxDQUFDO1lBQzdDLDBCQUEwQjtRQUM1QixDQUFDLEVBQUM7UUFDSixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQzs7Z0JBQ2IsSUFBSSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQztpQkFDakMsVUFBVSxFQUFFO2lCQUNaLFFBQVEsQ0FBQyxHQUFHLENBQUM7aUJBQ2IsSUFBSSxDQUFDLFdBQVc7Ozs7WUFBRSxVQUFDLENBQUM7Z0JBQ25CLE1BQU0sQ0FBQyxZQUFZLEdBQUcsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsR0FBRyxHQUFHLENBQUM7WUFDOUMsQ0FBQyxFQUFDO2lCQUNELElBQUksQ0FBQyxhQUFhLEVBQUUsUUFBUSxDQUFDO2lCQUM3QixJQUFJOzs7O1lBQUMsVUFBQyxDQUFDO2dCQUVOLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUE7Z0JBRXJDLHNCQUFzQjtZQUN4QixDQUFDLEVBQUM7aUJBQ0QsS0FBSyxDQUFDLE1BQU07Ozs7WUFBRSxVQUFDLENBQUM7Z0JBQ2YsRUFBRSxDQUFDLENBQUMsS0FBSSxDQUFDLFVBQVUsSUFBSSxLQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO29CQUNsRCxNQUFNLENBQUMsS0FBSSxDQUFDLFVBQVUsQ0FBQztnQkFDekIsQ0FBQztnQkFBQyxJQUFJLENBQUMsQ0FBQztvQkFDTixNQUFNLENBQUMsT0FBTyxDQUFDO2dCQUNqQixDQUFDO2dCQUNELHlFQUF5RTtZQUMzRSxDQUFDLEVBQUM7aUJBQ0QsS0FBSyxDQUFDLFdBQVcsRUFBRSxNQUFNLENBQUM7UUFDL0IsQ0FBQztJQUNILENBQUM7Ozs7SUFFRCxxREFBYzs7O0lBQWQ7UUFBQSxpQkFTQztRQVJDLElBQUksQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO1FBQ3RCLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTzs7OztRQUFDLFVBQUEsT0FBTzs7Z0JBQ25CLFlBQVksR0FBRyxFQUFFO1lBQ3JCLFlBQVksQ0FBQyxPQUFPLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3pELFlBQVksQ0FBQyxPQUFPLENBQUMsR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3pELFlBQVksQ0FBQyxPQUFPLENBQUMsR0FBRyxPQUFPLENBQUMsS0FBSyxDQUFDO1lBQ3RDLEtBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQyxDQUFDO1FBQ3RDLENBQUMsRUFBQyxDQUFDO0lBQ0wsQ0FBQzs7Ozs7SUFFRCx5REFBa0I7Ozs7SUFBbEIsVUFBbUIsV0FBZ0I7O1lBQzdCLEdBQUcsR0FBRyxFQUFFO1FBRVoscUNBQXFDO1FBQ3JDLHFDQUFxQztRQUNyQyxHQUFHLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxHQUFHLFdBQVcsQ0FBQyxLQUFLLENBQUM7UUFDMUMsR0FBRyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsR0FBRyxXQUFXLENBQUMsS0FBSyxDQUFDO1FBQzFDLHFCQUFxQjtRQUNyQixJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hCLENBQUM7Ozs7O0lBRUQsb0RBQWE7Ozs7SUFBYixVQUFjLElBQVM7UUFBdkIsaUJBWUM7UUFYQyxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN4QixJQUFJLENBQUMsT0FBTzs7Ozs7UUFBQyxVQUFDLE9BQU8sRUFBRSxLQUFLO1lBQzFCLEVBQUUsQ0FBQyxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDOztvQkFDVixhQUFXLEdBQUcsRUFBRTtnQkFDcEIsT0FBTyxDQUFDLE9BQU87Ozs7O2dCQUFDLFVBQUMsZUFBZSxFQUFFLFFBQVE7b0JBQ3hDLGFBQVcsQ0FBQyxLQUFJLENBQUMsUUFBUSxDQUFDLFFBQVEsQ0FBQyxDQUFDLEdBQUcsZUFBZSxDQUFDO2dCQUN6RCxDQUFDLEVBQUMsQ0FBQyxDQUFBLHFCQUFxQjtnQkFDeEIsS0FBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsYUFBVyxDQUFDLENBQUM7WUFDekMsQ0FBQyxDQUFBLFNBQVM7UUFDWixDQUFDLEVBQUMsQ0FBQyxDQUFBLHFCQUFxQjtRQUN4QixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxlQUFlLENBQUM7SUFDbkMsQ0FBQzs7Ozs7SUFFRCxzREFBZTs7OztJQUFmLFVBQWdCLFdBQWdCOztZQUMxQixNQUFNLEdBQUcsRUFBRTs7WUFDZixHQUFHLENBQUMsQ0FBcUIsSUFBQSxLQUFBLGlCQUFBLE1BQU0sQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUEsZ0JBQUE7Z0JBQTNDLElBQUEsZ0NBQVksRUFBWCxXQUFHLEVBQUUsYUFBSztnQkFDbEIsRUFBRSxDQUFDLENBQUMsR0FBRyxJQUFJLE9BQU8sSUFBSSxHQUFHLElBQUksV0FBVyxDQUFDLENBQUMsQ0FBQztvQkFDekMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQztnQkFDdEIsQ0FBQzthQUNGOzs7Ozs7Ozs7UUFDRCxNQUFNLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsQ0FBQzs7SUFDcEMsQ0FBQzs7Ozs7SUFFRCxzREFBZTs7OztJQUFmLFVBQWdCLEtBQVU7O1lBQ3BCLE1BQU0sR0FBRyxFQUFFOztZQUNmLEdBQUcsQ0FBQyxDQUFxQixJQUFBLEtBQUEsaUJBQUEsTUFBTSxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FBQSxnQkFBQTtnQkFBckMsSUFBQSxnQ0FBWSxFQUFYLFdBQUcsRUFBRSxhQUFLO2dCQUNsQixFQUFFLENBQUMsQ0FBQyxHQUFHLElBQUksT0FBTyxDQUFDLENBQUMsQ0FBQztvQkFDbkIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxHQUFHLEtBQUssQ0FBQztnQkFDdEIsQ0FBQzthQUNGOzs7Ozs7Ozs7UUFDRCxJQUFJLENBQUMsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFDOztJQUMxQixDQUFDOzs7OztJQUVELDZDQUFNOzs7O0lBQU4sVUFBTyxJQUFTO1FBRWQsSUFBSSxDQUFDLGFBQWEsR0FBRyxLQUFLLENBQUM7UUFDM0IsSUFBSSxDQUFDLFlBQVksR0FBRyxJQUFJLENBQUM7UUFDekIsSUFBSSxDQUFDLFdBQVcsRUFBRSxDQUFDO0lBRXJCLENBQUM7O2dCQW5URixTQUFTLFNBQUM7b0JBQ1QsUUFBUSxFQUFFLHVCQUF1QjtvQkFDakMsUUFBUSxFQUFFLDRvQ0F5Qkc7b0JBQ2IsTUFBTSxFQUFFLENBQUMsK0hBQStILENBQUM7aUJBQzFJOzs7Z0JBaENRLGlCQUFpQjtnQkFMc0QsaUJBQWlCO2dCQU14RixrQkFBa0I7OztzQkFrQ3hCLEtBQUssU0FBQyxLQUFLOzJCQUNYLEtBQUssU0FBQyxPQUFPOzRCQUNiLEtBQUssU0FBQyxRQUFROzBCQUNkLFNBQVMsU0FBQyxTQUFTO3dCQUNuQixTQUFTLFNBQUMsT0FBTzswQkFDakIsU0FBUyxTQUFDLFNBQVM7NEJBR25CLEtBQUs7O0lBNlFSLG1DQUFDO0NBQUEsQUFyVEQsQ0E4QmtELDBCQUEwQixHQXVSM0U7U0F2UlksNEJBQTRCOzs7SUFFdkMsMkNBQW1DOztJQUNuQyxnREFBdUM7O0lBQ3ZDLGlEQUF5Qzs7SUFDekMsK0NBQTBDOztJQUMxQyw2Q0FBc0M7O0lBQ3RDLCtDQUFtQzs7SUFDbkMscURBQStCOztJQUMvQixvREFBOEI7O0lBQzlCLGlEQUF3Qjs7SUFDeEIsZ0RBQXFCOztJQUNyQix1REFBNEI7O0lBQzVCLG1EQUF3Qjs7SUFDeEIsZ0RBQWM7O0lBQ2QsMkNBQVM7Ozs7O0lBQ0csaURBQW9DOzs7OztJQUFFLDJDQUE4Qjs7Ozs7SUFBRSw4Q0FBa0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uSW5pdCwgT3V0cHV0LCBWaWV3Q2hpbGQsIEVsZW1lbnRSZWYsIENoYW5nZURldGVjdG9yUmVmIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgKiBhcyBkMyBmcm9tICdkMyc7XG5pbXBvcnQgeyBBbWV4aW9EM0Jhc2VDaGFydENvbXBvbmVudCB9IGZyb20gJy4uL2Jhc2UvYmFzZS5jb21wb25lbnQnO1xuaW1wb3J0IHsgUGxvdENhcnQgfSBmcm9tICcuLi9iYXNlL2NoYXJ0LmNvbXBvbmVudCc7XG5pbXBvcnQgeyBIdHRwQ2xpZW50LCBIdHRwQ2xpZW50TW9kdWxlIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgQ29tbWFuRGF0YVNlcnZpY2UgfSBmcm9tICcuLi9zZXJ2aWNlcy9jb21tYW4uZGF0YS5zZXJ2aWNlJztcbmltcG9ydCB7IERldmljZVF1ZXJ5U2VydmljZSB9IGZyb20gJy4uL3NlcnZpY2VzL2RldmljZS5xdWVyeS5zZXJ2aWNlJztcblxuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnYW1leGlvLWQzLWNoYXJ0LWRvbnV0JyxcbiAgdGVtcGxhdGU6IGA8ZGl2ICpuZ0lmPVwiZHJpbGxhYmxlRmxhZ1wiICNjaGFydElkICh3aW5kb3c6cmVzaXplKT1cInJlc2l6ZSgkZXZlbnQpXCI+XG4gICAgPGRpdiAqbmdJZj1cImRhdGEubGVuZ3RoID4gMFwiPlxuXG4gIFxuICAgIDxkaXYgY29sc3Bhbj1cIjJcIiBzdHlsZT1cImZvbnQtc2l6ZTogMThweDsgZm9udC13ZWlnaHQ6IGJvbGQ7IFwiPlxuICAgICAgICB7e3RpdGxlfX1cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IFtuZ0NsYXNzXT1cIidkb251dGNzcydcIj5cbiAgICAgICAgPHN2ZyBwcmVzZXJ2ZUFzcGVjdFJhdGlvPVwieE1pbllNaW4gbWVldFwiIHZpZXdCb3g9XCIwIDAgMzAwIDMwMFwiIFthdHRyLmhlaWdodF09XCJoZWlnaHRcIiBbYXR0ci53aWR0aF09XCJ3aWR0aFwiIFthdHRyLmlkXT1cImNvbXBvbmVudElkXCI+XG4gICAgICAgIDwvc3ZnPlxuICAgICAgICA8ZGl2PlxuXG4gICAgICAgICAgICA8ZGl2IHN0eWxlPVwiZGlzcGxheTogYmxvY2s7IHBhZGRpbmc6IDElO1wiPlxuICAgICAgICAgICAgICAgIDxkaXYgKm5nSWY9XCJkZXNrdG9wbGVnZW5kXCI+XG4gICAgICAgICAgICAgICAgICAgIDxhbWV4aW8tZDMtbGVnZW5kICpuZ0lmPVwibGVnZW5kXCIgKG9uQ2xpY2spPVwib25Eb251dExlZ2VuZENsaWNrKCRldmVudClcIiBbZGF0YV09XCJsZWdlbmRBcnJheVwiIHN0eWxlPVwiaGVpZ2h0OjEwMCU7XCI+PC9hbWV4aW8tZDMtbGVnZW5kPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgICAgIDxkaXYgKm5nSWY9XCJtb2JpbGVsZWdlbmRcIj5cbiAgICAgICAgICAgICAgICAgICAgPGFtZXhpby1kMy1sZWdlbmQgKm5nSWY9XCJsZWdlbmRcIiBbaG9yaXpvbnRhbF09XCJ0cnVlXCIgKG9uQ2xpY2spPVwib25Eb251dExlZ2VuZENsaWNrKCRldmVudClcIiBbZGF0YV09XCJsZWdlbmRBcnJheVwiIHN0eWxlPVwiaGVpZ2h0OjEwMCU7XCI+PC9hbWV4aW8tZDMtbGVnZW5kPlxuICAgICAgICAgICAgICAgIDwvZGl2PlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8IS0tICAtLT5cbiAgICAgICAgPGRpdiAqbmdJZj1cImRhdGEubGVuZ3RoIDwgMVwiIGNsYXNzPVwibG1hc2tcIiBzdHlsZT1cInBhZGRpbmctdG9wOjUwJVwiPlxuICAgICAgICAgICAgPC9kaXY+XG5cbiAgICAgICAgPC9kaXY+YCxcbiAgc3R5bGVzOiBbYC5kb251dGNzc3tkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246cm93fUBtZWRpYSBzY3JlZW4gYW5kIChtYXgtd2lkdGg6MTAyNHB4KXsuZG9udXRjc3N7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOmNvbHVtbn19YF1cbn0pXG5leHBvcnQgY2xhc3MgQW1leGlvRDNEb3VudXRDaGFydENvbXBvbmVudCBleHRlbmRzIEFtZXhpb0QzQmFzZUNoYXJ0Q29tcG9uZW50IGltcGxlbWVudHMgUGxvdENhcnQge1xuXG4gIEBJbnB1dCgncGllJykgcGllOiBib29sZWFuID0gZmFsc2U7XG4gIEBJbnB1dCgnd2lkdGgnKSBzdmd3aWR0aDogbnVtYmVyID0gMzAwO1xuICBASW5wdXQoJ2hlaWdodCcpIHN2Z2hlaWdodDogbnVtYmVyID0gMzAwO1xuICBAVmlld0NoaWxkKCdjaGFydElkJykgY2hhcnRJZDogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnZGl2aWQnKSBkaXZpZDogRWxlbWVudFJlZjtcbiAgQFZpZXdDaGlsZCgnZHJpbGxpZCcpIGRyaWxsaWQ6IGFueTtcbiAgZGVza3RvcGxlZ2VuZDogYm9vbGVhbiA9IGZhbHNlO1xuICBtb2JpbGVsZWdlbmQ6IGJvb2xlYW4gPSBmYWxzZTtcbiAgQElucHV0KCkgZHJpbGxEYXRhOiBhbnk7XG4gIGtleUFycmF5OiBhbnlbXSA9IFtdO1xuICB0cmFuc2Zvcm1lZGRhdGE6IGFueVtdID0gW107XG4gIGxlZ2VuZEFycmF5OiBhbnlbXSA9IFtdO1xuICByZXNwb25zZTogYW55O1xuICBzdmc6IGFueTtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSBteXNlcnZpY2U6IENvbW1hbkRhdGFTZXJ2aWNlLCBwcml2YXRlIGNkZjogQ2hhbmdlRGV0ZWN0b3JSZWYsIHByaXZhdGUgZGV2aWNlOiBEZXZpY2VRdWVyeVNlcnZpY2UpIHtcbiAgICBzdXBlcignRE9OVVRDSEFSVCcpO1xuICB9XG5cbiAgbmdPbkluaXQoKSB7XG5cbiAgICBpZiAodGhpcy5sZXZlbCA8PSAxKSB7XG4gICAgICBsZXQgcmVzcDogYW55O1xuICAgICAgaWYgKHRoaXMuaHR0cG1ldGhvZCAmJiB0aGlzLmh0dHB1cmwpIHtcbiAgICAgICAgdGhpcy5teXNlcnZpY2UuZmV0Y2hVcmxEYXRhKHRoaXMuaHR0cHVybCwgdGhpcy5odHRwbWV0aG9kKS5zdWJzY3JpYmUoKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgICAgcmVzcCA9IHJlc3BvbnNlO1xuICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgfSwgKCkgPT4ge1xuXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmRhdGEgPSB0aGlzLmdldFJlc3BvbnNlRGF0YShyZXNwKTtcbiAgICAgICAgICAgIHRoaXMuZHJhd0NoYXJ0KCk7XG5cbiAgICAgICAgICAgIC8vIHRoaXMuZGF0YSA9IHRoaXMuZ2V0UmVzcG9uc2VEYXRhKHJlc3ApO1xuICAgICAgICAgICAgdGhpcy50cmFuc2Zvcm1EYXRhKHRoaXMuZGF0YSk7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxpemVEYXRhKCk7XG4gICAgICAgICAgICB0aGlzLnBsb3REM0NoYXJ0KCk7XG4gICAgICAgICAgfSwgMCk7XG4gICAgICAgIH0pO1xuXG4gICAgICB9IGVsc2VcbiAgICAgICAgaWYgKHRoaXMuZGF0YSkge1xuXG5cbiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuZGF0YSA9IHRoaXMuZ2V0UmVzcG9uc2VEYXRhKHRoaXMuZGF0YSk7XG4gICAgICAgICAgICB0aGlzLnRyYW5zZm9ybURhdGEodGhpcy5kYXRhKTtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbGl6ZURhdGEoKTtcbiAgICAgICAgICAgIHRoaXMucGxvdEQzQ2hhcnQoKTtcbiAgICAgICAgICB9LCAwKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG5cbiAgICAgIHRoaXMuZmV0Y2hEYXRhKHRoaXMuZHJpbGxEYXRhKTtcbiAgICB9XG4gIH1cblxuXG4gIGZldGNoRGF0YShkYXRhOiBhbnkpIHtcblxuICAgIGxldCByZXF1ZXN0SnNvbjtcbiAgICBsZXQga2V5ID0gdGhpcy5kcmlsbGFibGVkYXRha2V5O1xuICAgIGxldCByZXNwOiBhbnk7XG5cbiAgICBpZiAodGhpcy5kcmlsbGFibGVkYXRha2V5Lmxlbmd0aCkge1xuICAgICAgbGV0IGRyaWxsYWJsZWRhdGEgPSB0aGlzLmdldE11bHRpcGxlRHJpbGxibGVLZXlEYXRhKGRhdGEsIGtleSk7XG4gICAgICByZXF1ZXN0SnNvbiA9IGRyaWxsYWJsZWRhdGE7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgcmVxdWVzdEpzb24gPSBkYXRhO1xuICAgIH1cblxuICAgIGlmICh0aGlzLmh0dHBtZXRob2QgJiYgdGhpcy5odHRwdXJsKSB7XG4gICAgICB0aGlzLm15c2VydmljZS5wb3N0ZmV0Y2hEYXRhKHRoaXMuaHR0cHVybCwgdGhpcy5odHRwbWV0aG9kLCByZXF1ZXN0SnNvbikuc3Vic2NyaWJlKChyZXNwb25zZSkgPT4ge1xuICAgICAgICByZXNwID0gcmVzcG9uc2U7XG4gICAgICAgIHRoaXMucmVzcG9uc2UgPSByZXNwO1xuICAgICAgfSwgKGVycm9yKSA9PiB7XG4gICAgICB9LCAoKSA9PiB7XG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIHRoaXMuZGF0YSA9IHRoaXMuZ2V0UmVzcG9uc2VEYXRhKHJlc3ApO1xuXG4gICAgICAgICAgdGhpcy5kcmF3Q2hhcnQoKTtcblxuICAgICAgICB9LCAwKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuXG4gIGRyYXdDaGFydCgpIHtcbiAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuZHJpbGxhYmxlRmxhZyA9IHRydWU7XG4gICAgICB0aGlzLmluaXRpYWxpemVEYXRhKCk7XG4gICAgICB0aGlzLnBsb3REM0NoYXJ0KCk7XG4gICAgfSwgMCk7XG5cbiAgfVxuXG4gIGdldFJlc3BvbnNlRGF0YShodHRwUmVzcG9uc2U6IGFueSkge1xuICAgIGxldCByZXNwb25zZWRhdGEgPSBodHRwUmVzcG9uc2U7XG4gICAgaWYgKHRoaXMuZGF0YXJlYWRlciAhPSBudWxsKSB7XG4gICAgICBjb25zdCBkciA9IHRoaXMuZGF0YXJlYWRlci5zcGxpdCgnLicpO1xuICAgICAgZm9yIChjb25zdCBpciBvZiBkcikge1xuICAgICAgICByZXNwb25zZWRhdGEgPSByZXNwb25zZWRhdGFbaXJdO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICByZXNwb25zZWRhdGEgPSBodHRwUmVzcG9uc2U7XG4gICAgfVxuICAgIHJldHVybiByZXNwb25zZWRhdGE7XG4gIH1cbiAgcGxvdEQzQ2hhcnQoKSB7XG4gICAgdGhpcy5mb3JtTGVnZW5kRGF0YSgpO1xuICAgIC8vdGhpcy50cmFuc2Zvcm1EYXRhKHRoaXMuZGF0YSk7XG4gICAgLy8gIHRoaXMuZGF0YSA9IHRoaXMudHJhbnNmb3JtZWRkYXRhO1xuICAgIGxldCBvdXRlclJhZGl1cyA9IDA7XG4gICAgbGV0IGlubmVyUmFkaXVzID0gMDtcblxuICAgIG91dGVyUmFkaXVzID0gdGhpcy5zdmd3aWR0aCAvIDI7XG4gICAgaW5uZXJSYWRpdXMgPSB0aGlzLnN2Z3dpZHRoIC8gNDtcblxuICAgIGlmICh0aGlzLnBpZSkge1xuICAgICAgaW5uZXJSYWRpdXMgPSAwO1xuICAgIH1cblxuICAgIGNvbnN0IHRvb2x0aXAgPSB0aGlzLnRvb2xUaXAoZDMpO1xuXG4gICAgY29uc3QgYXJjID0gZDMuYXJjKClcbiAgICAgIC5vdXRlclJhZGl1cyhvdXRlclJhZGl1cylcbiAgICAgIC5pbm5lclJhZGl1cyhpbm5lclJhZGl1cyk7XG5cbiAgICBjb25zdCBwaWUgPSBkMy5waWUoKVxuICAgICAgLnZhbHVlKChkKSA9PiB7XG4gICAgICAgIHJldHVybiBkW09iamVjdC5rZXlzKGQpWzFdXTtcbiAgICAgICAgLy8gIHJldHVybiBkLnZhbHVlXG4gICAgICB9KTtcblxuICAgIHRoaXMuc3ZnID0gZDMuc2VsZWN0KFwiI1wiICsgdGhpcy5jb21wb25lbnRJZClcbiAgICAgIC5hcHBlbmQoJ2cnKVxuICAgICAgLmF0dHIoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGUoJyArIHRoaXMuc3Znd2lkdGggLyAyICsgJywnICsgdGhpcy5zdmdoZWlnaHQgLyAyICsgJyknKVxuICAgICAgLnNlbGVjdEFsbCgncGF0aCcpXG4gICAgICAuZGF0YShwaWUodGhpcy5kYXRhKSlcbiAgICAgIC5lbnRlcigpO1xuXG4gICAgaWYgKHRoaXMuZGV2aWNlLklzRGVza3RvcCgpID09IHRydWUpIHtcbiAgICAgIHRoaXMuZGVza3RvcGxlZ2VuZCA9IHRydWU7XG4gICAgICB0aGlzLm1vYmlsZWxlZ2VuZCA9IGZhbHNlO1xuICAgIH1cbiAgICAvLyBlbHNle1xuICAgIC8vICAgICAgICBpZih0aGlzLmRldmljZS5Jc1Bob25lKCk9PXRydWUgJiYgdGhpcy5kZXZpY2UuSXNUYWJsZXQoKT09dHJ1ZSlcbiAgICAvLyAgICAgICAge1xuICAgIC8vICAgICAgICAgICAgIHRoaXMuZGVza3RvcGxlZ2VuZD1mYWxzZTtcbiAgICAvLyAgICAgICAgICAgICB0aGlzLm1vYmlsZWxlZ2VuZD10cnVlO1xuICAgIC8vICAgICAgICB9XG4gICAgLy8gfVxuXG4gICAgY29uc3QgcGF0aCA9IHRoaXMuc3ZnLmFwcGVuZCgncGF0aCcpXG4gICAgICAuYXR0cignZCcsIGFyYylcbiAgICAgIC5hdHRyKCdmaWxsJywgKGQsIGkpID0+IHtcbiAgICAgICAgaWYgKGQuZGF0YS5jb2xvcikge1xuICAgICAgICAgIHJldHVybiBkLmRhdGEuY29sb3I7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIFwiYmxhY2tcIjtcbiAgICAgICAgfVxuICAgICAgICAvLyAgcmV0dXJuIChkICYmIGQuZGF0YSAmJiBkLmRhdGEuY29sb3IpID8gZC5kYXRhLmNvbG9yIDogXCJibGFja1wiXG4gICAgICB9KVxuICAgICAgLmF0dHIoJ2N1cnNvcicsICdwb2ludGVyJylcbiAgICAgIC5vbihcIm1vdXNlb3ZlclwiLCAoZCkgPT4ge1xuICAgICAgICByZXR1cm4gdG9vbHRpcC5zdHlsZShcInZpc2liaWxpdHlcIiwgXCJ2aXNpYmxlXCIpO1xuICAgICAgfSlcbiAgICAgIC5vbihcIm1vdXNlbW92ZVwiLCAoZCkgPT4ge1xuICAgICAgICByZXR1cm4gdG9vbHRpcC5odG1sKFxuICAgICAgICAgIHRoaXMuZm9ybVRvb2x0aXBEYXRhKGQuZGF0YSlcblxuICAgICAgICAgIC8vICB0aGlzLmZvcm1MZWdlbmREYXRhKGQuZGF0YSlcbiAgICAgICAgICAvLyB0aGlzLnRvb2xUaXBDb250ZW50KGQuZGF0YSlcbiAgICAgICAgKVxuICAgICAgICAgIC5zdHlsZShcInRvcFwiLCAoZDMuZXZlbnQucGFnZVkgLSAxMCkgKyBcInB4XCIpXG4gICAgICAgICAgLnN0eWxlKFwibGVmdFwiLCAoZDMuZXZlbnQucGFnZVggKyAxMCkgKyBcInB4XCIpO1xuICAgICAgfSlcbiAgICAgIC5vbihcIm1vdXNlb3V0XCIsIChkKSA9PiB7XG4gICAgICAgIHJldHVybiB0b29sdGlwLnN0eWxlKFwidmlzaWJpbGl0eVwiLCBcImhpZGRlblwiKTtcbiAgICAgIH0pXG4gICAgICAub24oXCJjbGlja1wiLCAoZCkgPT4ge1xuICAgICAgICB0aGlzLkRvbnV0Q2hhcnRDbGljayhkLmRhdGEpO1xuICAgICAgICB0aGlzLmZvcmRyaWxsYWJsZUNsaWNrKHRoaXMsIGQuZGF0YSwgZXZlbnQpO1xuICAgICAgICByZXR1cm4gdG9vbHRpcC5zdHlsZShcInZpc2liaWxpdHlcIiwgXCJoaWRkZW5cIik7XG4gICAgICAgIC8vdGhpcy5jaGFydENsaWNrKGQuZGF0YSk7XG4gICAgICB9KTtcbiAgICBpZiAodGhpcy5sYWJlbGZsYWcpIHtcbiAgICAgIGNvbnN0IHRleHQgPSB0aGlzLnN2Zy5hcHBlbmQoXCJ0ZXh0XCIpXG4gICAgICAgIC50cmFuc2l0aW9uKClcbiAgICAgICAgLmR1cmF0aW9uKDIwMClcbiAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgKGQpID0+IHtcbiAgICAgICAgICByZXR1cm4gXCJ0cmFuc2xhdGUoXCIgKyBhcmMuY2VudHJvaWQoZCkgKyBcIilcIjtcbiAgICAgICAgfSlcbiAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBcIm1pZGRsZVwiKVxuICAgICAgICAudGV4dCgoZCkgPT4ge1xuXG4gICAgICAgICAgcmV0dXJuIGQuZGF0YVtPYmplY3Qua2V5cyhkLmRhdGEpWzFdXVxuXG4gICAgICAgICAgLy9yZXR1cm4gZC5kYXRhLnZhbHVlO1xuICAgICAgICB9KVxuICAgICAgICAuc3R5bGUoJ2ZpbGwnLCAoZCkgPT4ge1xuICAgICAgICAgIGlmICh0aGlzLmxhYmVsY29sb3IgJiYgdGhpcy5sYWJlbGNvbG9yLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmxhYmVsY29sb3I7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBcImJsYWNrXCI7XG4gICAgICAgICAgfVxuICAgICAgICAgIC8vIHJldHVybiAoZCAmJiBkLmRhdGEgJiYgZC5kYXRhLnRleHRjb2xvcikgPyBkLmRhdGEudGV4dGNvbG9yIDogXCJibGFja1wiO1xuICAgICAgICB9KVxuICAgICAgICAuc3R5bGUoJ2ZvbnQtc2l6ZScsICcxMnB4Jyk7XG4gICAgfVxuICB9XG5cbiAgZm9ybUxlZ2VuZERhdGEoKSB7XG4gICAgdGhpcy5sZWdlbmRBcnJheSA9IFtdO1xuICAgIHRoaXMuZGF0YS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgbGV0IGxlZ2VuZG9iamVjdCA9IHt9O1xuICAgICAgbGVnZW5kb2JqZWN0WydsYWJlbCddID0gZWxlbWVudFtPYmplY3Qua2V5cyhlbGVtZW50KVswXV07XG4gICAgICBsZWdlbmRvYmplY3RbJ3ZhbHVlJ10gPSBlbGVtZW50W09iamVjdC5rZXlzKGVsZW1lbnQpWzFdXTtcbiAgICAgIGxlZ2VuZG9iamVjdFsnY29sb3InXSA9IGVsZW1lbnQuY29sb3I7XG4gICAgICB0aGlzLmxlZ2VuZEFycmF5LnB1c2gobGVnZW5kb2JqZWN0KTtcbiAgICB9KTtcbiAgfVxuXG4gIG9uRG9udXRMZWdlbmRDbGljayhsZWdlbmRldmVudDogYW55KSB7XG4gICAgbGV0IG9iaiA9IHt9O1xuXG4gICAgLy8gIG9ialsnbGFiZWwnXSA9IGxlZ2VuZGV2ZW50LmxhYmVsO1xuICAgIC8vICBvYmpbJ3ZhbHVlJ10gPSBsZWdlbmRldmVudC52YWx1ZSBcbiAgICBvYmpbdGhpcy5rZXlBcnJheVswXV0gPSBsZWdlbmRldmVudC5sYWJlbDtcbiAgICBvYmpbdGhpcy5rZXlBcnJheVsxXV0gPSBsZWdlbmRldmVudC52YWx1ZTtcbiAgICAvL2RlbGV0ZSBldmVudC5jb2xvcjtcbiAgICB0aGlzLmxlZ2VuZENsaWNrKG9iaik7XG4gIH1cblxuICB0cmFuc2Zvcm1EYXRhKGRhdGE6IGFueSkge1xuICAgIHRoaXMua2V5QXJyYXkgPSBkYXRhWzBdO1xuICAgIGRhdGEuZm9yRWFjaCgoZWxlbWVudCwgaW5kZXgpID0+IHtcbiAgICAgIGlmIChpbmRleCA+IDApIHtcbiAgICAgICAgbGV0IER1bW15T2JqZWN0ID0ge307XG4gICAgICAgIGVsZW1lbnQuZm9yRWFjaCgoaW5kaXZpZHVhbHZhbHVlLCBrZXlpbmRleCkgPT4ge1xuICAgICAgICAgIER1bW15T2JqZWN0W3RoaXMua2V5QXJyYXlba2V5aW5kZXhdXSA9IGluZGl2aWR1YWx2YWx1ZTtcbiAgICAgICAgfSk7Ly9pbm5lciBmb3IgbG9vcCBlbmRzXG4gICAgICAgIHRoaXMudHJhbnNmb3JtZWRkYXRhLnB1c2goRHVtbXlPYmplY3QpO1xuICAgICAgfS8vaWYgZW5kc1xuICAgIH0pOy8vb3V0ZXIgZm9yIGxvb3AgZW5kc1xuICAgIHRoaXMuZGF0YSA9IHRoaXMudHJhbnNmb3JtZWRkYXRhO1xuICB9XG5cbiAgZm9ybVRvb2x0aXBEYXRhKHRvb2x0aXBEYXRhOiBhbnkpIHtcbiAgICBsZXQgb2JqZWN0ID0ge307XG4gICAgZm9yIChsZXQgW2tleSwgdmFsdWVdIG9mIE9iamVjdC5lbnRyaWVzKHRvb2x0aXBEYXRhKSkge1xuICAgICAgaWYgKGtleSAhPSAnY29sb3InICYmIGtleSAhPSAndGV4dGNvbG9yJykge1xuICAgICAgICBvYmplY3Rba2V5XSA9IHZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy50b29sVGlwRm9yQmFyKG9iamVjdCk7XG4gIH1cblxuICBEb251dENoYXJ0Q2xpY2soZXZlbnQ6IGFueSkge1xuICAgIGxldCBvYmplY3QgPSB7fTtcbiAgICBmb3IgKGxldCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZXZlbnQpKSB7XG4gICAgICBpZiAoa2V5ICE9ICdjb2xvcicpIHtcbiAgICAgICAgb2JqZWN0W2tleV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5jaGFydENsaWNrKG9iamVjdCk7XG4gIH1cblxuICByZXNpemUoZGF0YTogYW55KSB7XG5cbiAgICB0aGlzLmRlc2t0b3BsZWdlbmQgPSBmYWxzZTtcbiAgICB0aGlzLm1vYmlsZWxlZ2VuZCA9IHRydWU7XG4gICAgdGhpcy5wbG90RDNDaGFydCgpO1xuXG4gIH1cblxufVxuIl19