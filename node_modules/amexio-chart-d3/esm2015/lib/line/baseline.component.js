/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Input } from "@angular/core";
import * as d3 from 'd3';
import { AmexioD3BaseChartComponent } from "../base/base.component";
export class AmexioD3BaseLineComponent extends AmexioD3BaseChartComponent {
    /**
     * @param {?} deviceQueryService
     */
    constructor(deviceQueryService) {
        super('line');
        this.deviceQueryService = deviceQueryService;
        this._data = [];
        this.xarr = [];
        this.displayindex = 0;
        this.svgheight = 300;
        // @Input('xaxis-interval') xtickscount: number = 3;
        this.linecolor = [];
        this.slant = false;
    }
    /**
     * @param {?} v
     * @return {?}
     */
    set data(v) {
        this._data = v;
        if (this._data && (this._data.length > 0)) {
            this.createXYAxisData();
        }
    }
    /**
     * @return {?}
     */
    get data() {
        return this._data;
    }
    /**
     * @protected
     * @return {?}
     */
    createXYAxisData() {
        this.labelcolor;
        this.xaxisdata = [];
        this.yaxisdata = [];
        this.multiseriesdata = [];
        this.legenddata = [];
        this.legends = [];
        this.xaxisname = this.data[0][0].label;
        /** @type {?} */
        const msdarray = [];
        /** @type {?} */
        let count = 0
        // ************************************************
        ;
        // ************************************************
        if (this.displayfield) {
            // find displayfield index
            this._data[0].forEach((/**
             * @param {?} element
             * @param {?} index
             * @return {?}
             */
            (element, index) => {
                if (element.label == this.displayfield) {
                    this.displayindex = index;
                }
            }));
        }
        // ***********************************************
        for (let index = 0; index < this._data[0].length; index++) {
            /** @type {?} */
            const legend = this._data[0][index];
            msdarray[index] = [];
            /** @type {?} */
            let obj = {};
            obj['label'] = legend.label;
            if ((this.linecolor.length > 0) && this.linecolor[index]) {
                obj['color'] = this.linecolor[index];
            }
            else {
                obj['color'] = this.predefinedcolors[index];
            }
            this.legenddata.push(obj);
            // this.legenddata.push({'label':legend.label,'color':this.predefinedcolors[index+1]});
            if (index > 0) {
                /** @type {?} */
                let obj = {};
                obj['label'] = legend.label;
                if ((this.linecolor.length > 0) && this.linecolor[count]) {
                    obj['color'] = this.linecolor[count];
                }
                else {
                    obj['color'] = this.predefinedcolors[count];
                }
                this.legends.push(obj);
                count++;
                // this.legends.push({'label':legend.label,'color':this.predefinedcolors[index]});
            }
        }
        /** @type {?} */
        let i = 0;
        // xaxisdata yaxisdata msdarray is formed here
        this._data.forEach((/**
         * @param {?} object
         * @return {?}
         */
        object => {
            if (i > 0) {
                /** @type {?} */
                let j = 0;
                /** @type {?} */
                let xobj = {};
                object.forEach((/**
                 * @param {?} a
                 * @return {?}
                 */
                a => {
                    // if (j === 0) {
                    //     this.xaxisdata.push({ 'label': a, 'value': a });
                    // } else {
                    //     this.yaxisdata.push({ 'label': a, 'value': a });
                    // }
                    if ((j > 0) && (j !== this.displayindex)) {
                        this.yaxisdata.push({ 'label': a, 'value': a });
                    }
                    if (j == 0) {
                        xobj['value'] = a;
                    }
                    if (j == this.displayindex) {
                        xobj['label'] = a;
                    }
                    msdarray[j].push(a);
                    j++;
                }));
                this.xaxisdata.push(xobj);
            }
            i++;
        }));
        for (let index = 0; index < msdarray.length; index++) {
            /** @type {?} */
            const element = msdarray[index];
            if ((index > 0) && (index !== this.displayindex)) {
                /** @type {?} */
                let md = [];
                for (let j = 0; j < element.length; j++) {
                    /** @type {?} */
                    const v = element[j];
                    md.push({ 'legend': this.legenddata[index].label, 'label': this.xaxisdata[j].label, 'value': v });
                }
                this.multiseriesdata.push(md);
                this.legends[index - 1].data = md;
            }
        }
    }
    /**
     * @param {?} width
     * @return {?}
     */
    recalculatescale(width) {
        // consider fontsize to be 10
        this.xaxisdata;
        /** @type {?} */
        let summationwidth = 0;
        if (!this.displayfield) {
            this.xaxisdata.forEach((/**
             * @param {?} element
             * @return {?}
             */
            element => {
                if (typeof (element.label) == 'string') {
                    summationwidth = summationwidth + (element.label.length * 10);
                }
                if (typeof (element.label) == 'number') {
                    /** @type {?} */
                    let n = this.findDigitCount(element.label);
                    summationwidth = summationwidth + (n * 10);
                }
            }));
        }
        if (this.displayfield) {
            this.xaxisdata.forEach((/**
             * @param {?} element
             * @return {?}
             */
            element => {
                // if (typeof (element.label) == 'string') {
                summationwidth = summationwidth + (element.label.length * 10);
                // }
            }));
        }
        if (this.displayfield && this.slant) {
            summationwidth = this.xaxisdata.length * 10;
        }
        if (summationwidth > width) {
            //  function call
            this.calculatexaxisarray(summationwidth, width);
        }
    }
    /**
     * @param {?} summationwidth
     * @param {?} width
     * @return {?}
     */
    calculatexaxisarray(summationwidth, width) {
        /** @type {?} */
        let interval = Math.round(summationwidth / width);
        this.generateNewAxis(interval, width);
    }
    /**
     * @param {?} interval
     * @param {?} avlwidth
     * @return {?}
     */
    generateNewAxis(interval, avlwidth) {
        this.xaxisdata;
        /** @type {?} */
        let arr = [];
        /** @type {?} */
        let newarr = [];
        /** @type {?} */
        let min;
        /** @type {?} */
        let max;
        //    make Array out of this.xaxisdata
        this.xaxisdata.forEach((/**
         * @param {?} element
         * @return {?}
         */
        element => {
            // if (typeof (element.label) == 'number') {
            arr.push(element.label);
            // }
        }));
        //null check on arr
        if (arr.length > 0) {
            // find min
            min = Math.min.apply(null, arr);
            //find max
            max = Math.max.apply(null, arr);
            /** @type {?} */
            let temp = Math.round(avlwidth / 10);
            /** @type {?} */
            let differential = (temp - (temp * 0.2)) / 4;
            //form new arr
            /** @type {?} */
            let j = Math.round(differential);
            //   hjlkllll
            /** @type {?} */
            let i;
            /** @type {?} */
            let isredundant = false;
            if (!this.displayfield) {
                newarr[0] = min;
                for (i = 1; j < this.xaxisdata.length; i++) {
                    j = Math.round((differential * i) + i);
                    isredundant = this.checkArrayRedundancy(newarr, Math.round(j));
                    if (isredundant) {
                        newarr[i] = Math.round(j + 1);
                    }
                    else {
                        newarr[i] = Math.round(j);
                    }
                }
                this.sortarr(newarr);
            }
            if (this.displayfield) {
                for (i = 0; j < this.xaxisdata.length; i++) {
                    j = Math.round((differential * i) + i);
                    if (this.xaxisdata[j]) {
                        newarr[i] = this.xaxisdata[j].label;
                    }
                    else {
                        if (this.xaxisdata[j + 1]) {
                            newarr[i] = this.xaxisdata[j + 1].label;
                        }
                    }
                }
                this.xarr = newarr;
            }
        }
    }
    /**
     * @param {?} newarr
     * @param {?} chknum
     * @return {?}
     */
    checkArrayRedundancy(newarr, chknum) {
        /** @type {?} */
        let inc = 0;
        newarr.forEach((/**
         * @param {?} element
         * @return {?}
         */
        element => {
            if (chknum == element) {
                inc++;
            }
        }));
        if (inc > 1) {
            return true;
        }
        else {
            return false;
        }
    }
    /**
     * @param {?} newarr
     * @return {?}
     */
    sortarr(newarr) {
        /** @type {?} */
        let i;
        /** @type {?} */
        let j;
        /** @type {?} */
        let temp;
        for (i = 0; i < newarr.length; ++i) {
            for (j = i + 1; j < newarr.length; ++j) {
                if (newarr[i] > newarr[j]) {
                    temp = newarr[i];
                    newarr[i] = newarr[j];
                    newarr[j] = temp;
                }
            }
        }
        //    newarr;
        this.setXaxisData(newarr);
    }
    /**
     * @param {?} newarr
     * @return {?}
     */
    setXaxisData(newarr) {
        this.xarr = newarr;
        // this.xaxisdata.push({label: 125, value: 125});
        // chk if newarr elements are present in xaxisdata
        /** @type {?} */
        let ispresent = false;
        newarr.forEach((/**
         * @param {?} arrelement
         * @return {?}
         */
        arrelement => {
            this.xaxisdata.forEach((/**
             * @param {?} xaxiselement
             * @return {?}
             */
            xaxiselement => {
                if (arrelement == xaxiselement.label) {
                    ispresent = true;
                }
            }));
            if (!ispresent) {
                //create & push an obj in xaxisdata
                /** @type {?} */
                let obj = { label: arrelement, value: arrelement };
                this.xaxisdata.push(obj);
            }
            ispresent = false;
        }));
        //  
        // change arr to arr of objs
        /** @type {?} */
        let xdata = [];
        newarr.forEach((/**
         * @param {?} element
         * @return {?}
         */
        (element) => {
            /** @type {?} */
            let obj = { label: element, value: element };
            xdata.push(obj);
        }));
        this.xaxisdata;
        this.xaxisdata1 = xdata;
        //initialize xaxis data
    }
    /**
     * @param {?} n
     * @return {?}
     */
    findDigitCount(n) {
        /** @type {?} */
        let count = 0;
        if (n >= 1)
            ++count;
        while (n / 10 >= 1) {
            n /= 10;
            ++count;
        }
        return count;
    }
    /**
     * @param {?} width
     * @return {?}
     */
    setXinterval(width) {
        /** @type {?} */
        let interval = Math.round(this.xaxisdata.length / this.xinterval);
        /** @type {?} */
        let arr = [];
        /** @type {?} */
        let newarr = [];
        //    make Array out of this.xaxisdata
        this.xaxisdata.forEach((/**
         * @param {?} element
         * @return {?}
         */
        element => {
            if (typeof (element.label) == 'number') {
                arr.push(element.label);
            }
        }));
        /** @type {?} */
        let min = Math.min.apply(null, arr);
        //find max
        /** @type {?} */
        let max = Math.max.apply(null, arr);
        /** @type {?} */
        let j = interval;
        /** @type {?} */
        let i;
        /** @type {?} */
        let ispresent = false;
        newarr[0] = min;
        // assa
        for (i = 1; j < max; i++) {
            j = interval * i;
            newarr[i] = j;
        }
        // newarr[i] = max;
        //inset numbers which are not present in xaxis domain but present in newarr
        newarr.forEach((/**
         * @param {?} arrelement
         * @return {?}
         */
        arrelement => {
            this.xaxisdata.forEach((/**
             * @param {?} xaxiselement
             * @return {?}
             */
            xaxiselement => {
                if (xaxiselement.label == arrelement) {
                    ispresent = true;
                }
            }));
            if (!ispresent) {
                /** @type {?} */
                let obj = { label: arrelement, value: arrelement };
                this.xaxisdata.push(obj);
            }
            ispresent = false;
        }));
        // this.sortarr(newarr);
        // newarr;
        // this.xaxisdata;
        this.xarr = newarr;
    }
    /**
     * @param {?} width
     * @return {?}
     */
    setDisplayfieldXinterval(width) {
        /** @type {?} */
        let interval = Math.round(this.xaxisdata.length / this.xinterval);
        /** @type {?} */
        let arr = [];
        /** @type {?} */
        let newarr = [];
        //    make Array out of this.xaxisdata
        this.xaxisdata.forEach((/**
         * @param {?} element
         * @return {?}
         */
        element => {
            arr.push(element.label);
        }));
        /** @type {?} */
        let min = 0;
        /** @type {?} */
        let max = this.xaxisdata.length - 1;
        /** @type {?} */
        let j = interval;
        /** @type {?} */
        let i;
        newarr[0] = this.xaxisdata[min].label;
        for (i = 1; j < max; i++) {
            newarr[i] = this.xaxisdata[j].label;
            j = interval * i;
        }
        newarr.push(this.xaxisdata[max].label);
        this.xarr = newarr;
    }
    // formatxaxisarr() {
    //     let formattedarr = [];
    //     let temp = '';
    //     if(this.xarr) {
    //     if (typeof (this.xarr[0]) == 'string') {
    //         // treat string
    //         this.xarr.forEach(element => {
    //             if (typeof (element) == 'string') {
    //                 temp = '';
    //                 temp = element[0] + element[1] + '..'
    //                 formattedarr.push(temp)
    //             }
    //         });
    //          this.xarr = formattedarr;
    //     }
    //     if (typeof (this.xarr[0]) == 'number') {
    //         // treat numerials
    //         // wrap numbers
    //     }
    //              }
    // }
    /**
     * @protected
     * @return {?}
     */
    initChart() {
        /** @type {?} */
        const tooltip = this.toolTip(d3);
        //RESIZE STEP 2 START
        this.svg = d3.select("#" + this.componentId)
            .attr('viewBox', '0 0 ' + this.svgwidth + ' ' + this.svgheight);
        this.svg.selectAll("*").remove();
        /** @type {?} */
        const margin = { top: 40, right: 20, bottom: 30, left: 40 };
        //RESIZE STEP 2 ENDS HERE
        /** @type {?} */
        const width = +this.svgwidth - margin.left - margin.right;
        // this.xaxisdata;
        if (this.xinterval) {
            if (!this.displayfield) {
                this.setXinterval(width);
            }
            if (this.displayfield) {
                this.setDisplayfieldXinterval(width);
            }
        }
        else {
            this.recalculatescale(width);
        }
        /** @type {?} */
        const height = +this.svgheight - margin.top - margin.bottom;
        /** @type {?} */
        const g = this.svg.append("g")
            .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
        /** @type {?} */
        const x = d3.scalePoint()
            .rangeRound([0, width])
            .padding(0.1);
        /** @type {?} */
        const y = d3.scaleLinear()
            .rangeRound([height, 0]);
        /** @type {?} */
        let xdomain;
        if (this.xaxisdata) {
            x.domain(this.xaxisdata.map((/**
             * @param {?} d
             * @return {?}
             */
            (d) => {
                if (typeof (d.label) == 'string') {
                    return d.label;
                }
                else {
                    return parseInt(d.value);
                }
            })));
        }
        if (this.yaxisdata) {
            y.domain([0, d3.max(this.yaxisdata, (/**
                 * @param {?} d
                 * @return {?}
                 */
                (d) => { return d.value; }))]);
        }
        //add axis
        /** @type {?} */
        let xaxisbottom = d3.axisBottom(x);
        if (this.xarr.length > 0) {
            // if(this.slant) {
            // this.formatxaxisarr();
            //  }
            xaxisbottom.tickValues(this.xarr);
        }
        if (this.deviceQueryService.IsDesktop() == true) {
            if (this.svgwidth <= 400) {
                g.append("g")
                    .attr("transform", "translate(0," + height + ")")
                    .call(xaxisbottom
                // d3.axisBottom(x)
                // .tickValues(this.xarr)
                ).
                    selectAll("text")
                    .attr("y", 0)
                    .attr("x", 9)
                    .attr("dy", ".35em")
                    .attr("transform", "rotate(60)")
                    .style("text-anchor", "start");
            }
            else {
                /** @type {?} */
                let bottomaxis = g.append("g")
                    .attr("transform", "translate(0," + height + ")")
                    .call(xaxisbottom);
                if (this.slant) {
                    // this.formatxaxisarr(); 
                    bottomaxis.selectAll("text")
                        .attr("cursor", "pointer")
                        .on("mouseover", (/**
                     * @param {?} d
                     * @return {?}
                     */
                    (d) => {
                        return tooltip.style("visibility", "visible");
                    }))
                        .on("mousemove", (/**
                     * @param {?} d
                     * @return {?}
                     */
                    (d) => {
                        return tooltip.html(this.callXaxisTooltip(d))
                            .style("top", (d3.event.pageY - 10) + "px")
                            .style("left", (d3.event.pageX + 10) + "px");
                    }))
                        .on("mouseout", (/**
                     * @param {?} d
                     * @return {?}
                     */
                    (d) => {
                        return tooltip.style("visibility", "hidden");
                    }))
                        .on("click", (/**
                     * @param {?} d
                     * @return {?}
                     */
                    (d) => {
                        return tooltip.style("visibility", "hidden");
                    }))
                        .attr("y", 0)
                        .attr("x", 9)
                        .attr("dy", ".35em")
                        .attr("transform", "rotate(90)")
                        .style("text-anchor", "start")
                        .style("font-size", 10);
                }
            }
        }
        else {
            g.append("g")
                .attr("transform", "translate(0," + height + ")")
                .call(xaxisbottom).
                selectAll("text")
                .attr("y", 0)
                .attr("x", 9)
                .attr("dy", ".35em")
                .attr("transform", "rotate(60)")
                .style("text-anchor", "start")
                .style("font-size", 10);
            ;
        }
        g.append("g")
            .call(d3.axisLeft(y).ticks(this.tickscount));
        // tickSize(0,10));
        /** @type {?} */
        let rawdata = this._data;
        // call function to alter legends if displayfield condn satisfy
        this.alterLegend();
        return {
            g, x, y, height, width, rawdata
        };
        // 
    }
    /**
     * @protected
     * @param {?} g
     * @param {?} x
     * @param {?} y
     * @param {?} height
     * @param {?} width
     * @return {?}
     */
    plotScale(g, x, y, height, width) {
        if (this.vScale) {
            g.append('g')
                .attr("color", "lightgrey")
                .attr('transform', 'translate(0,' + height + ')')
                .call(d3.axisBottom(x).
                tickSize(-this.width).tickFormat(''));
        }
        if (this.hScale) {
            g.append('g')
                .attr("color", "lightgrey")
                .call(d3.axisLeft(y).ticks(this.tickscount)
                .tickSize(-width).tickFormat(''));
        }
    }
    /**
     * @param {?} node
     * @return {?}
     */
    legendClick(node) {
        // const legendNode = JSON.parse(JSON.stringify(node));
        // delete legendNode.color;
        // legendNode.data.forEach(element => {
        //     delete element.legend;
        // });
        // const legendNode = JSON.parse(JSON.stringify(node));
        // delete legendNode.color;
        // legendNode.data.forEach(element => {
        //     delete element.legend;
        // });
        /** @type {?} */
        let obj = {};
        obj["label"] = node.label;
        /** @type {?} */
        let data = [];
        node.data.forEach((/**
         * @param {?} element
         * @return {?}
         */
        element => {
            /** @type {?} */
            let object = {};
            object[element.legend] = element.value;
            object[this.xaxisname] = element.label;
            //   object[element.label] = element.value;
            data.push(object);
        }));
        obj["data"] = data;
        this.onLegendClick.emit(obj);
        // this.onLegendClick.emit(legendNode);
    }
    /**
     * @return {?}
     */
    alterLegend() {
        this.linelegends = [];
        if (this.displayfield) {
            this.legends.forEach((/**
             * @param {?} element
             * @return {?}
             */
            element => {
                if (element.label !== this.displayfield) {
                    this.linelegends.push(element);
                }
            }));
        }
        else {
            this.linelegends = this.legends;
        }
    }
    /**
     * @param {?} tooltipdata
     * @return {?}
     */
    callXaxisTooltip(tooltipdata) {
        /** @type {?} */
        var obj = {};
        obj['x-axis'] = tooltipdata;
        return this.toolTipForBar(obj);
    }
}
AmexioD3BaseLineComponent.propDecorators = {
    svgwidth: [{ type: Input, args: ['width',] }],
    svgheight: [{ type: Input, args: ['height',] }],
    xinterval: [{ type: Input, args: ['data',] }, { type: Input, args: ['xaxis-interval',] }],
    httpurl: [{ type: Input, args: ['http-url',] }],
    httpmethod: [{ type: Input, args: ['http-method',] }],
    tickscount: [{ type: Input, args: ['yaxis-interval',] }],
    linecolor: [{ type: Input, args: ['color',] }],
    displayfield: [{ type: Input, args: ['display-field',] }],
    slant: [{ type: Input, args: ['rotate',] }]
};
if (false) {
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.svgwidth;
    /**
     * @type {?}
     * @private
     */
    AmexioD3BaseLineComponent.prototype._data;
    /**
     * @type {?}
     * @private
     */
    AmexioD3BaseLineComponent.prototype.xaxisdata;
    /**
     * @type {?}
     * @private
     */
    AmexioD3BaseLineComponent.prototype.xaxisdata1;
    /**
     * @type {?}
     * @private
     */
    AmexioD3BaseLineComponent.prototype.yaxisdata;
    /**
     * @type {?}
     * @private
     */
    AmexioD3BaseLineComponent.prototype.legenddata;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.legends;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.linelegends;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.xarr;
    /**
     * @type {?}
     * @protected
     */
    AmexioD3BaseLineComponent.prototype.xaxisname;
    /**
     * @type {?}
     * @protected
     */
    AmexioD3BaseLineComponent.prototype.multiseriesdata;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.svg;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.displayindex;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.svgheight;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.xinterval;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.httpurl;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.httpmethod;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.tickscount;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.linecolor;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.displayfield;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.slant;
    /** @type {?} */
    AmexioD3BaseLineComponent.prototype.deviceQueryService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzZWxpbmUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vYW1leGlvLWNoYXJ0LWQzLyIsInNvdXJjZXMiOlsibGliL2xpbmUvYmFzZWxpbmUuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQ3RDLE9BQU8sS0FBSyxFQUFFLE1BQU0sSUFBSSxDQUFDO0FBQ3pCLE9BQU8sRUFBRSwwQkFBMEIsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBSXBFLE1BQU0sZ0NBQWlDLFNBQVEsMEJBQTBCOzs7O0lBZ0NyRSxZQUFtQixrQkFBc0M7UUFDckQsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBREMsdUJBQWtCLEdBQWxCLGtCQUFrQixDQUFvQjtRQTlCakQsVUFBSyxHQUFRLEVBQUUsQ0FBQztRQU94QixTQUFJLEdBQVUsRUFBRSxDQUFDO1FBSWpCLGlCQUFZLEdBQVcsQ0FBQyxDQUFDO1FBQ1IsY0FBUyxHQUFHLEdBQUcsQ0FBQztRQVdqQyxvREFBb0Q7UUFDcEMsY0FBUyxHQUFHLEVBQUUsQ0FBQztRQUlkLFVBQUssR0FBRyxLQUFLLENBQUM7SUFJL0IsQ0FBQzs7Ozs7SUFFRCxJQUFJLElBQUksQ0FBQyxDQUFNO1FBQ1gsSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDLENBQUM7UUFDZixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxNQUFNLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQ3hDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQzVCLENBQUM7SUFFTCxDQUFDOzs7O0lBRUQsSUFBSSxJQUFJO1FBQ0osTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUM7SUFDdEIsQ0FBQzs7Ozs7SUFFUyxnQkFBZ0I7UUFDdEIsSUFBSSxDQUFDLFVBQVUsQ0FBQTtRQUNmLElB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LENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUM7UUFDcEMsQ0FBQztJQUNMLENBQUM7Ozs7O0lBRUQsZ0JBQWdCLENBQUMsV0FBZ0I7O1lBQ3pCLEdBQUcsR0FBRyxFQUFFO1FBQ1osR0FBRyxDQUFDLFFBQVEsQ0FBQyxHQUFHLFdBQVcsQ0FBQztRQUM1QixNQUFNLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNuQyxDQUFDOzs7dUJBanFCQSxLQUFLLFNBQUMsT0FBTzt3QkFhYixLQUFLLFNBQUMsUUFBUTt3QkFFZCxLQUFLLFNBQUMsTUFBTSxjQUVaLEtBQUssU0FBQyxnQkFBZ0I7c0JBRXRCLEtBQUssU0FBQyxVQUFVO3lCQUVoQixLQUFLLFNBQUMsYUFBYTt5QkFFbkIsS0FBSyxTQUFDLGdCQUFnQjt3QkFFdEIsS0FBSyxTQUFDLE9BQU87MkJBRWIsS0FBSyxTQUFDLGVBQWU7b0JBRXJCLEtBQUssU0FBQyxRQUFROzs7O0lBN0JmLDZDQUFpQzs7Ozs7SUFDakMsMENBQXdCOzs7OztJQUN4Qiw4Q0FBeUI7Ozs7O0lBQ3pCLCtDQUEwQjs7Ozs7SUFDMUIsOENBQXlCOzs7OztJQUN6QiwrQ0FBMEI7O0lBQzFCLDRDQUFlOztJQUNmLGdEQUFtQjs7SUFDbkIseUNBQWlCOzs7OztJQUNqQiw4Q0FBeUI7Ozs7O0lBQ3pCLG9EQUFpQzs7SUFDakMsd0NBQVM7O0lBQ1QsaURBQXlCOztJQUN6Qiw4Q0FBaUM7O0lBRWpDLDhDQUUyQzs7SUFFM0MsNENBQWdDOztJQUVoQywrQ0FBc0M7O0lBRXRDLCtDQUE0Qzs7SUFFNUMsOENBQStCOztJQUUvQixpREFBNkM7O0lBRTdDLDBDQUErQjs7SUFFbkIsdURBQTZDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSW5wdXQgfSBmcm9tIFwiQGFuZ3VsYXIvY29yZVwiO1xuaW1wb3J0ICogYXMgZDMgZnJvbSAnZDMnO1xuaW1wb3J0IHsgQW1leGlvRDNCYXNlQ2hhcnRDb21wb25lbnQgfSBmcm9tIFwiLi4vYmFzZS9iYXNlLmNvbXBvbmVudFwiO1xuaW1wb3J0IHsgRGV2aWNlUXVlcnlTZXJ2aWNlIH0gZnJvbSAnLi4vc2VydmljZXMvZGV2aWNlLnF1ZXJ5LnNlcnZpY2UnO1xuaW1wb3J0IHsgbmVhcmVyIH0gZnJvbSBcInFcIjtcblxuZXhwb3J0IGNsYXNzIEFtZXhpb0QzQmFzZUxpbmVDb21wb25lbnQgZXh0ZW5kcyBBbWV4aW9EM0Jhc2VDaGFydENvbXBvbmVudCB7XG4gICAgQElucHV0KCd3aWR0aCcpIHN2Z3dpZHRoOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBfZGF0YTogYW55ID0gW107XG4gICAgcHJpdmF0ZSB4YXhpc2RhdGE6IGFueVtdO1xuICAgIHByaXZhdGUgeGF4aXNkYXRhMTogYW55W107XG4gICAgcHJpdmF0ZSB5YXhpc2RhdGE6IGFueVtdO1xuICAgIHByaXZhdGUgbGVnZW5kZGF0YTogYW55W107XG4gICAgbGVnZW5kczogYW55W107XG4gICAgbGluZWxlZ2VuZHM6IGFueVtdO1xuICAgIHhhcnI6IGFueVtdID0gW107XG4gICAgcHJvdGVjdGVkIHhheGlzbmFtZTogYW55O1xuICAgIHByb3RlY3RlZCBtdWx0aXNlcmllc2RhdGE6IGFueVtdO1xuICAgIHN2ZzogYW55O1xuICAgIGRpc3BsYXlpbmRleDogbnVtYmVyID0gMDtcbiAgICBASW5wdXQoJ2hlaWdodCcpIHN2Z2hlaWdodCA9IDMwMDtcblxuICAgIEBJbnB1dCgnZGF0YScpXG5cbiAgICBASW5wdXQoJ3hheGlzLWludGVydmFsJykgeGludGVydmFsOiBudW1iZXI7XG5cbiAgICBASW5wdXQoJ2h0dHAtdXJsJykgaHR0cHVybDogYW55O1xuXG4gICAgQElucHV0KCdodHRwLW1ldGhvZCcpIGh0dHBtZXRob2Q6IGFueTtcblxuICAgIEBJbnB1dCgneWF4aXMtaW50ZXJ2YWwnKSB0aWNrc2NvdW50OiBudW1iZXI7XG4gICAgLy8gQElucHV0KCd4YXhpcy1pbnRlcnZhbCcpIHh0aWNrc2NvdW50OiBudW1iZXIgPSAzO1xuICAgIEBJbnB1dCgnY29sb3InKSBsaW5lY29sb3IgPSBbXTtcblxuICAgIEBJbnB1dCgnZGlzcGxheS1maWVsZCcpIGRpc3BsYXlmaWVsZDogc3RyaW5nO1xuXG4gICAgQElucHV0KCdyb3RhdGUnKSBzbGFudCA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIGRldmljZVF1ZXJ5U2VydmljZTogRGV2aWNlUXVlcnlTZXJ2aWNlKSB7XG4gICAgICAgIHN1cGVyKCdsaW5lJyk7XG4gICAgfVxuXG4gICAgc2V0IGRhdGEodjogYW55KSB7XG4gICAgICAgIHRoaXMuX2RhdGEgPSB2O1xuICAgICAgICBpZiAodGhpcy5fZGF0YSAmJiAodGhpcy5fZGF0YS5sZW5ndGggPiAwKSkge1xuICAgICAgICAgICAgdGhpcy5jcmVhdGVYWUF4aXNEYXRhKCk7XG4gICAgICAgIH1cblxuICAgIH1cblxuICAgIGdldCBkYXRhKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgY3JlYXRlWFlBeGlzRGF0YSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5sYWJlbGNvbG9yXG4gICAgICAgIHRoaXMueGF4aXNkYXRhID0gW107XG4gICAgICAgIHRoaXMueWF4aXNkYXRhID0gW107XG4gICAgICAgIHRoaXMubXVsdGlzZXJpZXNkYXRhID0gW107XG4gICAgICAgIHRoaXMubGVnZW5kZGF0YSA9IFtdO1xuICAgICAgICB0aGlzLmxlZ2VuZHMgPSBbXTtcbiAgICAgICAgdGhpcy54YXhpc25hbWUgPSB0aGlzLmRhdGFbMF1bMF0ubGFiZWw7XG4gICAgICAgIGNvbnN0IG1zZGFycmF5OiBhbnlbXSA9IFtdO1xuICAgICAgICBsZXQgY291bnQgPSAwXG4gICAgICAgIC8vICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuICAgICAgICBpZiAodGhpcy5kaXNwbGF5ZmllbGQpIHtcbiAgICAgICAgICAgIC8vIGZpbmQgZGlzcGxheWZpZWxkIGluZGV4XG5cbiAgICAgICAgICAgIHRoaXMuX2RhdGFbMF0uZm9yRWFjaCgoZWxlbWVudCwgaW5kZXgpID0+IHtcblxuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmxhYmVsID09IHRoaXMuZGlzcGxheWZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZGlzcGxheWluZGV4ID0gaW5kZXg7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKlxuXG4gICAgICAgIGZvciAobGV0IGluZGV4ID0gMDsgaW5kZXggPCB0aGlzLl9kYXRhWzBdLmxlbmd0aDsgaW5kZXgrKykge1xuICAgICAgICAgICAgY29uc3QgbGVnZW5kID0gdGhpcy5fZGF0YVswXVtpbmRleF07XG4gICAgICAgICAgICBtc2RhcnJheVtpbmRleF0gPSBbXTtcbiAgICAgICAgICAgIGxldCBvYmogPSB7fTtcbiAgICAgICAgICAgIG9ialsnbGFiZWwnXSA9IGxlZ2VuZC5sYWJlbDtcbiAgICAgICAgICAgIGlmICgodGhpcy5saW5lY29sb3IubGVuZ3RoID4gMCkgJiYgdGhpcy5saW5lY29sb3JbaW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgb2JqWydjb2xvciddID0gdGhpcy5saW5lY29sb3JbaW5kZXhdO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgb2JqWydjb2xvciddID0gdGhpcy5wcmVkZWZpbmVkY29sb3JzW2luZGV4XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMubGVnZW5kZGF0YS5wdXNoKG9iaik7XG4gICAgICAgICAgICAvLyB0aGlzLmxlZ2VuZGRhdGEucHVzaCh7J2xhYmVsJzpsZWdlbmQubGFiZWwsJ2NvbG9yJzp0aGlzLnByZWRlZmluZWRjb2xvcnNbaW5kZXgrMV19KTtcbiAgICAgICAgICAgIGlmIChpbmRleCA+IDApIHtcbiAgICAgICAgICAgICAgICBsZXQgb2JqID0ge307XG4gICAgICAgICAgICAgICAgb2JqWydsYWJlbCddID0gbGVnZW5kLmxhYmVsO1xuICAgICAgICAgICAgICAgIGlmICgodGhpcy5saW5lY29sb3IubGVuZ3RoID4gMCkgJiYgdGhpcy5saW5lY29sb3JbY291bnRdKSB7XG4gICAgICAgICAgICAgICAgICAgIG9ialsnY29sb3InXSA9IHRoaXMubGluZWNvbG9yW2NvdW50XTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBvYmpbJ2NvbG9yJ10gPSB0aGlzLnByZWRlZmluZWRjb2xvcnNbY291bnRdO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmxlZ2VuZHMucHVzaChvYmopO1xuICAgICAgICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgICAgICAgICAgLy8gdGhpcy5sZWdlbmRzLnB1c2goeydsYWJlbCc6bGVnZW5kLmxhYmVsLCdjb2xvcic6dGhpcy5wcmVkZWZpbmVkY29sb3JzW2luZGV4XX0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cblxuICAgICAgICBsZXQgaSA9IDA7XG4gICAgICAgIC8vIHhheGlzZGF0YSB5YXhpc2RhdGEgbXNkYXJyYXkgaXMgZm9ybWVkIGhlcmVcblxuICAgICAgICB0aGlzLl9kYXRhLmZvckVhY2gob2JqZWN0ID0+IHtcblxuICAgICAgICAgICAgaWYgKGkgPiAwKSB7XG4gICAgICAgICAgICAgICAgbGV0IGogPSAwO1xuICAgICAgICAgICAgICAgIGxldCB4b2JqID0ge307XG4gICAgICAgICAgICAgICAgb2JqZWN0LmZvckVhY2goYSA9PiB7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gaWYgKGogPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRoaXMueGF4aXNkYXRhLnB1c2goeyAnbGFiZWwnOiBhLCAndmFsdWUnOiBhIH0pO1xuICAgICAgICAgICAgICAgICAgICAvLyB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyAgICAgdGhpcy55YXhpc2RhdGEucHVzaCh7ICdsYWJlbCc6IGEsICd2YWx1ZSc6IGEgfSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAoKGogPiAwKSAmJiAoaiAhPT0gdGhpcy5kaXNwbGF5aW5kZXgpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnlheGlzZGF0YS5wdXNoKHsgJ2xhYmVsJzogYSwgJ3ZhbHVlJzogYSB9KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmIChqID09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhvYmpbJ3ZhbHVlJ10gPSBhO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGogPT0gdGhpcy5kaXNwbGF5aW5kZXgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHhvYmpbJ2xhYmVsJ10gPSBhO1xuICAgICAgICAgICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgICAgICAgICBtc2RhcnJheVtqXS5wdXNoKGEpO1xuICAgICAgICAgICAgICAgICAgICBqKys7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLnhheGlzZGF0YS5wdXNoKHhvYmopO1xuXG5cblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaSsrO1xuICAgICAgICB9KTtcblxuICAgICAgICBmb3IgKGxldCBpbmRleCA9IDA7IGluZGV4IDwgbXNkYXJyYXkubGVuZ3RoOyBpbmRleCsrKSB7XG5cbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBtc2RhcnJheVtpbmRleF07XG5cbiAgICAgICAgICAgIGlmICgoaW5kZXggPiAwKSAmJiAoaW5kZXggIT09IHRoaXMuZGlzcGxheWluZGV4KSkge1xuXG4gICAgICAgICAgICAgICAgbGV0IG1kOiBhbnlbXSA9IFtdO1xuICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgZWxlbWVudC5sZW5ndGg7IGorKykge1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHYgPSBlbGVtZW50W2pdO1xuICAgICAgICAgICAgICAgICAgICBtZC5wdXNoKHsgJ2xlZ2VuZCc6IHRoaXMubGVnZW5kZGF0YVtpbmRleF0ubGFiZWwsICdsYWJlbCc6IHRoaXMueGF4aXNkYXRhW2pdLmxhYmVsLCAndmFsdWUnOiB2IH0pO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMubXVsdGlzZXJpZXNkYXRhLnB1c2gobWQpO1xuICAgICAgICAgICAgICAgIHRoaXMubGVnZW5kc1tpbmRleCAtIDFdLmRhdGEgPSBtZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJlY2FsY3VsYXRlc2NhbGUod2lkdGg6IGFueSkge1xuXG4gICAgICAgIC8vIGNvbnNpZGVyIGZvbnRzaXplIHRvIGJlIDEwXG4gICAgICAgIHRoaXMueGF4aXNkYXRhO1xuICAgICAgICBsZXQgc3VtbWF0aW9ud2lkdGggPSAwO1xuICAgICAgICBpZiAoIXRoaXMuZGlzcGxheWZpZWxkKSB7XG4gICAgICAgICAgICB0aGlzLnhheGlzZGF0YS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKGVsZW1lbnQubGFiZWwpID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIHN1bW1hdGlvbndpZHRoID0gc3VtbWF0aW9ud2lkdGggKyAoZWxlbWVudC5sYWJlbC5sZW5ndGggKiAxMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgKGVsZW1lbnQubGFiZWwpID09ICdudW1iZXInKSB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBuID0gdGhpcy5maW5kRGlnaXRDb3VudChlbGVtZW50LmxhYmVsKTtcbiAgICAgICAgICAgICAgICAgICAgc3VtbWF0aW9ud2lkdGggPSBzdW1tYXRpb253aWR0aCArIChuICogMTApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuZGlzcGxheWZpZWxkKSB7XG4gICAgICAgICAgICB0aGlzLnhheGlzZGF0YS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgICAgIC8vIGlmICh0eXBlb2YgKGVsZW1lbnQubGFiZWwpID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgc3VtbWF0aW9ud2lkdGggPSBzdW1tYXRpb253aWR0aCArIChlbGVtZW50LmxhYmVsLmxlbmd0aCAqIDEwKTtcbiAgICAgICAgICAgICAgICAvLyB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmRpc3BsYXlmaWVsZCAmJiB0aGlzLnNsYW50KSB7XG4gICAgICAgICAgICBzdW1tYXRpb253aWR0aCA9IHRoaXMueGF4aXNkYXRhLmxlbmd0aCAqIDEwO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHN1bW1hdGlvbndpZHRoID4gd2lkdGgpIHtcbiAgICAgICAgICAgIC8vICBmdW5jdGlvbiBjYWxsXG5cbiAgICAgICAgICAgIHRoaXMuY2FsY3VsYXRleGF4aXNhcnJheShzdW1tYXRpb253aWR0aCwgd2lkdGgpO1xuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICBjYWxjdWxhdGV4YXhpc2FycmF5KHN1bW1hdGlvbndpZHRoOiBhbnksIHdpZHRoOiBhbnkpIHtcblxuICAgICAgICBsZXQgaW50ZXJ2YWwgPSBNYXRoLnJvdW5kKHN1bW1hdGlvbndpZHRoIC8gd2lkdGgpO1xuICAgICAgICAgdGhpcy5nZW5lcmF0ZU5ld0F4aXMoaW50ZXJ2YWwsIHdpZHRoKTtcbiAgICB9XG5cbiAgICBnZW5lcmF0ZU5ld0F4aXMoaW50ZXJ2YWwsIGF2bHdpZHRoKSB7XG4gICAgICAgIHRoaXMueGF4aXNkYXRhXG5cbiAgICAgICAgbGV0IGFyciA9IFtdO1xuICAgICAgICBsZXQgbmV3YXJyID0gW107XG4gICAgICAgIGxldCBtaW47XG4gICAgICAgIGxldCBtYXg7XG4gICAgICAgIC8vICAgIG1ha2UgQXJyYXkgb3V0IG9mIHRoaXMueGF4aXNkYXRhXG4gICAgICAgIHRoaXMueGF4aXNkYXRhLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICAvLyBpZiAodHlwZW9mIChlbGVtZW50LmxhYmVsKSA9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgYXJyLnB1c2goZWxlbWVudC5sYWJlbCk7XG4gICAgICAgICAgICAvLyB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vbnVsbCBjaGVjayBvbiBhcnJcbiAgICAgICAgaWYgKGFyci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAvLyBmaW5kIG1pblxuXG4gICAgICAgICAgICBtaW4gPSBNYXRoLm1pbi5hcHBseShudWxsLCBhcnIpO1xuICAgICAgICAgICAgLy9maW5kIG1heFxuICAgICAgICAgICAgbWF4ID0gTWF0aC5tYXguYXBwbHkobnVsbCwgYXJyKTtcblxuICAgICAgICAgICAgbGV0IHRlbXAgPSBNYXRoLnJvdW5kKGF2bHdpZHRoIC8gMTApXG4gICAgICAgICAgICBsZXQgZGlmZmVyZW50aWFsID0gKHRlbXAgLSAodGVtcCAqIDAuMikpIC8gNDtcblxuICAgICAgICAgICAgLy9mb3JtIG5ldyBhcnJcblxuICAgICAgICAgICAgbGV0IGogPSBNYXRoLnJvdW5kKGRpZmZlcmVudGlhbCk7XG4gICAgICAgICAgICAvLyAgIGhqbGtsbGxsXG4gICAgICAgICAgICBsZXQgaTtcbiAgICAgICAgICAgIGxldCBpc3JlZHVuZGFudCA9IGZhbHNlO1xuXG4gICAgICAgICAgICBpZiAoIXRoaXMuZGlzcGxheWZpZWxkKSB7XG4gICAgICAgICAgICAgICAgbmV3YXJyWzBdID0gbWluO1xuXG4gICAgICAgICAgICAgICAgZm9yIChpID0gMTsgaiA8IHRoaXMueGF4aXNkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgIGogPSBNYXRoLnJvdW5kKChkaWZmZXJlbnRpYWwgKiBpKSArIGkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlzcmVkdW5kYW50ID0gdGhpcy5jaGVja0FycmF5UmVkdW5kYW5jeShuZXdhcnIsIE1hdGgucm91bmQoaikpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoaXNyZWR1bmRhbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld2FycltpXSA9IE1hdGgucm91bmQoaiArIDEpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3YXJyW2ldID0gTWF0aC5yb3VuZChqKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMuc29ydGFycihuZXdhcnIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAodGhpcy5kaXNwbGF5ZmllbGQpIHtcbiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBqIDwgdGhpcy54YXhpc2RhdGEubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgICAgICAgICBqID0gTWF0aC5yb3VuZCgoZGlmZmVyZW50aWFsICogaSkgKyBpKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy54YXhpc2RhdGFbal0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld2FycltpXSA9IHRoaXMueGF4aXNkYXRhW2pdLmxhYmVsO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMueGF4aXNkYXRhW2ogKyAxXSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld2FycltpXSA9IHRoaXMueGF4aXNkYXRhW2ogKyAxXS5sYWJlbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRoaXMueGFyciA9IG5ld2FycjtcblxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2hlY2tBcnJheVJlZHVuZGFuY3kobmV3YXJyLCBjaGtudW0pIHtcbiAgICAgICAgbGV0IGluYyA9IDBcbiAgICAgICAgbmV3YXJyLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICBpZiAoY2hrbnVtID09IGVsZW1lbnQpIHtcbiAgICAgICAgICAgICAgICBpbmMrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgaWYgKGluYyA+IDEpIHtcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNvcnRhcnIobmV3YXJyOiBhbnkpIHtcbiAgICAgICAgbGV0IGk7XG4gICAgICAgIGxldCBqO1xuICAgICAgICBsZXQgdGVtcDtcbiAgICAgICAgZm9yIChpID0gMDsgaSA8IG5ld2Fyci5sZW5ndGg7ICsraSkge1xuXG4gICAgICAgICAgICBmb3IgKGogPSBpICsgMTsgaiA8IG5ld2Fyci5sZW5ndGg7ICsraikge1xuXG4gICAgICAgICAgICAgICAgaWYgKG5ld2FycltpXSA+IG5ld2FycltqXSkge1xuXG4gICAgICAgICAgICAgICAgICAgIHRlbXAgPSBuZXdhcnJbaV07XG4gICAgICAgICAgICAgICAgICAgIG5ld2FycltpXSA9IG5ld2FycltqXTtcbiAgICAgICAgICAgICAgICAgICAgbmV3YXJyW2pdID0gdGVtcDtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICAvLyAgICBuZXdhcnI7XG4gICAgICAgIHRoaXMuc2V0WGF4aXNEYXRhKG5ld2FycilcbiAgICB9XG5cbiAgICBzZXRYYXhpc0RhdGEobmV3YXJyOiBhbnkpIHtcblxuICAgICAgICB0aGlzLnhhcnIgPSBuZXdhcnI7XG5cbiAgICAgICAgLy8gdGhpcy54YXhpc2RhdGEucHVzaCh7bGFiZWw6IDEyNSwgdmFsdWU6IDEyNX0pO1xuXG4gICAgICAgIC8vIGNoayBpZiBuZXdhcnIgZWxlbWVudHMgYXJlIHByZXNlbnQgaW4geGF4aXNkYXRhXG4gICAgICAgIGxldCBpc3ByZXNlbnQgPSBmYWxzZTtcbiAgICAgICAgbmV3YXJyLmZvckVhY2goYXJyZWxlbWVudCA9PiB7XG4gICAgICAgICAgICB0aGlzLnhheGlzZGF0YS5mb3JFYWNoKHhheGlzZWxlbWVudCA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGFycmVsZW1lbnQgPT0geGF4aXNlbGVtZW50LmxhYmVsKSB7XG4gICAgICAgICAgICAgICAgICAgIGlzcHJlc2VudCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghaXNwcmVzZW50KSB7XG4gICAgICAgICAgICAgICAgLy9jcmVhdGUgJiBwdXNoIGFuIG9iaiBpbiB4YXhpc2RhdGFcbiAgICAgICAgICAgICAgICBsZXQgb2JqID0geyBsYWJlbDogYXJyZWxlbWVudCwgdmFsdWU6IGFycmVsZW1lbnQgfTtcbiAgICAgICAgICAgICAgICB0aGlzLnhheGlzZGF0YS5wdXNoKG9iaik7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlzcHJlc2VudCA9IGZhbHNlO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyAgXG5cbiAgICAgICAgLy8gY2hhbmdlIGFyciB0byBhcnIgb2Ygb2Jqc1xuICAgICAgICBsZXQgeGRhdGEgPSBbXTtcbiAgICAgICAgbmV3YXJyLmZvckVhY2goKGVsZW1lbnQ6IGFueSkgPT4ge1xuICAgICAgICAgICAgbGV0IG9iaiA9IHsgbGFiZWw6IGVsZW1lbnQsIHZhbHVlOiBlbGVtZW50IH1cbiAgICAgICAgICAgIHhkYXRhLnB1c2gob2JqKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMueGF4aXNkYXRhO1xuICAgICAgICB0aGlzLnhheGlzZGF0YTEgPSB4ZGF0YTtcbiAgICAgICAgLy9pbml0aWFsaXplIHhheGlzIGRhdGFcbiAgICB9XG5cbiAgICBmaW5kRGlnaXRDb3VudChuOiBudW1iZXIpIHtcbiAgICAgICAgbGV0IGNvdW50ID0gMDtcbiAgICAgICAgaWYgKG4gPj0gMSkrK2NvdW50O1xuXG4gICAgICAgIHdoaWxlIChuIC8gMTAgPj0gMSkge1xuICAgICAgICAgICAgbiAvPSAxMDtcbiAgICAgICAgICAgICsrY291bnQ7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgIH1cblxuICAgIHNldFhpbnRlcnZhbCh3aWR0aDogbnVtYmVyKSB7XG4gICAgICAgIGxldCBpbnRlcnZhbCA9IE1hdGgucm91bmQodGhpcy54YXhpc2RhdGEubGVuZ3RoIC8gdGhpcy54aW50ZXJ2YWwpO1xuXG4gICAgICAgIGxldCBhcnIgPSBbXTtcbiAgICAgICAgbGV0IG5ld2FyciA9IFtdO1xuICAgICAgICAvLyAgICBtYWtlIEFycmF5IG91dCBvZiB0aGlzLnhheGlzZGF0YVxuICAgICAgICB0aGlzLnhheGlzZGF0YS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiAoZWxlbWVudC5sYWJlbCkgPT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgICAgICBhcnIucHVzaChlbGVtZW50LmxhYmVsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cblxuICAgICAgICBsZXQgbWluID0gTWF0aC5taW4uYXBwbHkobnVsbCwgYXJyKTtcbiAgICAgICAgLy9maW5kIG1heFxuICAgICAgICBsZXQgbWF4ID0gTWF0aC5tYXguYXBwbHkobnVsbCwgYXJyKTtcbiAgICAgICAgbGV0IGogPSBpbnRlcnZhbDtcbiAgICAgICAgbGV0IGk7XG4gICAgICAgIGxldCBpc3ByZXNlbnQgPSBmYWxzZTtcbiAgICAgICAgbmV3YXJyWzBdID0gbWluO1xuICAgICAgICAvLyBhc3NhXG4gICAgICAgIGZvciAoaSA9IDE7IGogPCBtYXg7IGkrKykge1xuICAgICAgICAgICAgaiA9IGludGVydmFsICogaTtcbiAgICAgICAgICAgIG5ld2FycltpXSA9IGo7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBuZXdhcnJbaV0gPSBtYXg7XG5cbiAgICAgICAgLy9pbnNldCBudW1iZXJzIHdoaWNoIGFyZSBub3QgcHJlc2VudCBpbiB4YXhpcyBkb21haW4gYnV0IHByZXNlbnQgaW4gbmV3YXJyXG5cbiAgICAgICAgbmV3YXJyLmZvckVhY2goYXJyZWxlbWVudCA9PiB7XG5cbiAgICAgICAgICAgIHRoaXMueGF4aXNkYXRhLmZvckVhY2goeGF4aXNlbGVtZW50ID0+IHtcblxuICAgICAgICAgICAgICAgIGlmICh4YXhpc2VsZW1lbnQubGFiZWwgPT0gYXJyZWxlbWVudCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGlzcHJlc2VudCA9IHRydWVcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFpc3ByZXNlbnQpIHtcblxuICAgICAgICAgICAgICAgIGxldCBvYmogPSB7IGxhYmVsOiBhcnJlbGVtZW50LCB2YWx1ZTogYXJyZWxlbWVudCB9XG4gICAgICAgICAgICAgICAgdGhpcy54YXhpc2RhdGEucHVzaChvYmopO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpc3ByZXNlbnQgPSBmYWxzZTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gdGhpcy5zb3J0YXJyKG5ld2Fycik7XG5cbiAgICAgICAgLy8gbmV3YXJyO1xuICAgICAgICAvLyB0aGlzLnhheGlzZGF0YTtcbiAgICAgICAgdGhpcy54YXJyID0gbmV3YXJyO1xuXG4gICAgfVxuXG4gICAgc2V0RGlzcGxheWZpZWxkWGludGVydmFsKHdpZHRoKSB7XG4gICAgICAgIGxldCBpbnRlcnZhbCA9IE1hdGgucm91bmQodGhpcy54YXhpc2RhdGEubGVuZ3RoIC8gdGhpcy54aW50ZXJ2YWwpO1xuXG4gICAgICAgIGxldCBhcnIgPSBbXTtcbiAgICAgICAgbGV0IG5ld2FyciA9IFtdO1xuICAgICAgICAvLyAgICBtYWtlIEFycmF5IG91dCBvZiB0aGlzLnhheGlzZGF0YVxuICAgICAgICB0aGlzLnhheGlzZGF0YS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgYXJyLnB1c2goZWxlbWVudC5sYWJlbCk7XG4gICAgICAgIH0pO1xuICAgICAgICBsZXQgbWluID0gMDtcbiAgICAgICAgbGV0IG1heCA9IHRoaXMueGF4aXNkYXRhLmxlbmd0aCAtIDE7XG4gICAgICAgIGxldCBqID0gaW50ZXJ2YWw7XG4gICAgICAgIGxldCBpO1xuICAgICAgICBuZXdhcnJbMF0gPSB0aGlzLnhheGlzZGF0YVttaW5dLmxhYmVsO1xuICAgICAgICBmb3IgKGkgPSAxOyBqIDwgbWF4OyBpKyspIHtcbiAgICAgICAgICAgIG5ld2FycltpXSA9IHRoaXMueGF4aXNkYXRhW2pdLmxhYmVsO1xuICAgICAgICAgICAgaiA9IGludGVydmFsICogaTtcbiAgICAgICAgfVxuICAgICAgICBuZXdhcnIucHVzaCh0aGlzLnhheGlzZGF0YVttYXhdLmxhYmVsKVxuICAgICAgICB0aGlzLnhhcnIgPSBuZXdhcnI7XG4gICAgfVxuXG4gICAgLy8gZm9ybWF0eGF4aXNhcnIoKSB7XG4gICAgLy8gICAgIGxldCBmb3JtYXR0ZWRhcnIgPSBbXTtcbiAgICAvLyAgICAgbGV0IHRlbXAgPSAnJztcblxuICAgIC8vICAgICBpZih0aGlzLnhhcnIpIHtcblxuICAgIC8vICAgICBpZiAodHlwZW9mICh0aGlzLnhhcnJbMF0pID09ICdzdHJpbmcnKSB7XG4gICAgLy8gICAgICAgICAvLyB0cmVhdCBzdHJpbmdcbiAgICAvLyAgICAgICAgIHRoaXMueGFyci5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICBcbiAgICAvLyAgICAgICAgICAgICBpZiAodHlwZW9mIChlbGVtZW50KSA9PSAnc3RyaW5nJykge1xuICAgIC8vICAgICAgICAgICAgICAgICB0ZW1wID0gJyc7XG4gICAgLy8gICAgICAgICAgICAgICAgIHRlbXAgPSBlbGVtZW50WzBdICsgZWxlbWVudFsxXSArICcuLidcbiAgICAvLyAgICAgICAgICAgICAgICAgZm9ybWF0dGVkYXJyLnB1c2godGVtcClcbiAgICAvLyAgICAgICAgICAgICB9XG4gICAgLy8gICAgICAgICB9KTtcbiAgICAvLyAgICAgICAgICB0aGlzLnhhcnIgPSBmb3JtYXR0ZWRhcnI7XG4gICAgLy8gICAgIH1cblxuICAgIC8vICAgICBpZiAodHlwZW9mICh0aGlzLnhhcnJbMF0pID09ICdudW1iZXInKSB7XG4gICAgLy8gICAgICAgICAvLyB0cmVhdCBudW1lcmlhbHNcbiAgICAvLyAgICAgICAgIC8vIHdyYXAgbnVtYmVyc1xuXG4gICAgLy8gICAgIH1cbiAgICAvLyAgICAgICAgICAgICAgfVxuICAgIC8vIH1cblxuXG4gICAgcHJvdGVjdGVkIGluaXRDaGFydCgpOiBhbnkge1xuICAgICAgICBjb25zdCB0b29sdGlwID0gdGhpcy50b29sVGlwKGQzKTtcbiAgICAgICAgLy9SRVNJWkUgU1RFUCAyIFNUQVJUXG4gICAgICAgIHRoaXMuc3ZnID0gZDMuc2VsZWN0KFwiI1wiICsgdGhpcy5jb21wb25lbnRJZClcbiAgICAgICAgICAgIC5hdHRyKCd2aWV3Qm94JywgJzAgMCAnICsgdGhpcy5zdmd3aWR0aCArICcgJyArIHRoaXMuc3ZnaGVpZ2h0KTtcbiAgICAgICAgdGhpcy5zdmcuc2VsZWN0QWxsKFwiKlwiKS5yZW1vdmUoKTtcblxuICAgICAgICBjb25zdCBtYXJnaW4gPSB7IHRvcDogNDAsIHJpZ2h0OiAyMCwgYm90dG9tOiAzMCwgbGVmdDogNDAgfTtcbiAgICAgICAgLy9SRVNJWkUgU1RFUCAyIEVORFMgSEVSRVxuICAgICAgICBjb25zdCB3aWR0aCA9ICt0aGlzLnN2Z3dpZHRoIC0gbWFyZ2luLmxlZnQgLSBtYXJnaW4ucmlnaHQ7XG4gICAgICAgIC8vIHRoaXMueGF4aXNkYXRhO1xuXG4gICAgICAgIGlmICh0aGlzLnhpbnRlcnZhbCkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmRpc3BsYXlmaWVsZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0WGludGVydmFsKHdpZHRoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmRpc3BsYXlmaWVsZCkge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0RGlzcGxheWZpZWxkWGludGVydmFsKHdpZHRoKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnJlY2FsY3VsYXRlc2NhbGUod2lkdGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gK3RoaXMuc3ZnaGVpZ2h0IC0gbWFyZ2luLnRvcCAtIG1hcmdpbi5ib3R0b207XG4gICAgICAgIGNvbnN0IGcgPSB0aGlzLnN2Zy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZShcIiArIG1hcmdpbi5sZWZ0ICsgXCIsXCIgKyBtYXJnaW4udG9wICsgXCIpXCIpO1xuXG4gICAgICAgIGNvbnN0IHggPSBkMy5zY2FsZVBvaW50KClcbiAgICAgICAgICAgIC5yYW5nZVJvdW5kKFswLCB3aWR0aF0pXG4gICAgICAgICAgICAucGFkZGluZygwLjEpO1xuXG4gICAgICAgIGNvbnN0IHkgPSBkMy5zY2FsZUxpbmVhcigpXG4gICAgICAgICAgICAucmFuZ2VSb3VuZChbaGVpZ2h0LCAwXSk7XG4gICAgICAgIGxldCB4ZG9tYWluO1xuICAgICAgICBpZiAodGhpcy54YXhpc2RhdGEpIHtcblxuICAgICAgICAgICAgeC5kb21haW4odGhpcy54YXhpc2RhdGEubWFwKChkKSA9PiB7XG5cbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIChkLmxhYmVsKSA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZC5sYWJlbDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBwYXJzZUludChkLnZhbHVlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKVxuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLnlheGlzZGF0YSkge1xuICAgICAgICAgICAgeS5kb21haW4oWzAsIGQzLm1heCh0aGlzLnlheGlzZGF0YSwgKGQpID0+IHsgcmV0dXJuIGQudmFsdWU7IH0pXSk7XG4gICAgICAgIH1cbiAgICAgICAgLy9hZGQgYXhpc1xuICAgICAgICBsZXQgeGF4aXNib3R0b20gPSBkMy5heGlzQm90dG9tKHgpO1xuICAgICAgICBpZiAodGhpcy54YXJyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIC8vIGlmKHRoaXMuc2xhbnQpIHtcbiAgICAgICAgICAgIC8vIHRoaXMuZm9ybWF0eGF4aXNhcnIoKTtcbiAgICAgICAgICAgIC8vICB9XG4gICAgICAgICAgICAgeGF4aXNib3R0b20udGlja1ZhbHVlcyh0aGlzLnhhcnIpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZGV2aWNlUXVlcnlTZXJ2aWNlLklzRGVza3RvcCgpID09IHRydWUpIHtcbiAgICAgICAgICAgIGlmICh0aGlzLnN2Z3dpZHRoIDw9IDQwMCkge1xuXG4gICAgICAgICAgICAgICAgZy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlKDAsXCIgKyBoZWlnaHQgKyBcIilcIilcbiAgICAgICAgICAgICAgICAgICAgLmNhbGwoeGF4aXNib3R0b21cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGQzLmF4aXNCb3R0b20oeClcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIC50aWNrVmFsdWVzKHRoaXMueGFycilcbiAgICAgICAgICAgICAgICAgICAgKS5cbiAgICAgICAgICAgICAgICAgICAgc2VsZWN0QWxsKFwidGV4dFwiKVxuXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieVwiLCAwKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInhcIiwgOSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkeVwiLCBcIi4zNWVtXCIpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwicm90YXRlKDYwKVwiKVxuICAgICAgICAgICAgICAgICAgICAuc3R5bGUoXCJ0ZXh0LWFuY2hvclwiLCBcInN0YXJ0XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgbGV0IGJvdHRvbWF4aXMgPSBnLmFwcGVuZChcImdcIilcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCxcIiArIGhlaWdodCArIFwiKVwiKVxuICAgICAgICAgICAgICAgICAgICAuY2FsbCh4YXhpc2JvdHRvbSlcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLnNsYW50KSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoaXMuZm9ybWF0eGF4aXNhcnIoKTsgXG5cbiAgICAgICAgICAgICAgICAgICAgYm90dG9tYXhpcy5zZWxlY3RBbGwoXCJ0ZXh0XCIpXG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwiY3Vyc29yXCIsIFwicG9pbnRlclwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uKFwibW91c2VvdmVyXCIsIChkKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRvb2x0aXAuc3R5bGUoXCJ2aXNpYmlsaXR5XCIsIFwidmlzaWJsZVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZW1vdmVcIiwgKGQpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdG9vbHRpcC5odG1sKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGxYYXhpc1Rvb2x0aXAoZCkpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZShcInRvcFwiLCAoZDMuZXZlbnQucGFnZVkgLSAxMCkgKyBcInB4XCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZShcImxlZnRcIiwgKGQzLmV2ZW50LnBhZ2VYICsgMTApICsgXCJweFwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAub24oXCJtb3VzZW91dFwiLCAoZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0b29sdGlwLnN0eWxlKFwidmlzaWJpbGl0eVwiLCBcImhpZGRlblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAub24oXCJjbGlja1wiLCAoZCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0b29sdGlwLnN0eWxlKFwidmlzaWJpbGl0eVwiLCBcImhpZGRlblwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG5cblxuXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInlcIiwgMClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKFwieFwiLCA5KVxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJkeVwiLCBcIi4zNWVtXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBcInJvdGF0ZSg5MClcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZShcInRleHQtYW5jaG9yXCIsIFwic3RhcnRcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zdHlsZShcImZvbnQtc2l6ZVwiLCAxMCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgZy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGUoMCxcIiArIGhlaWdodCArIFwiKVwiKVxuICAgICAgICAgICAgICAgIC8vICAgLmF0dHIoXCJjb2xvclwiLCBcImdyZXlcIilcbiAgICAgICAgICAgICAgICAuY2FsbCh4YXhpc2JvdHRvbSkuXG4gICAgICAgICAgICAgICAgc2VsZWN0QWxsKFwidGV4dFwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieVwiLCAwKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwieFwiLCA5KVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiZHlcIiwgXCIuMzVlbVwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIFwicm90YXRlKDYwKVwiKVxuICAgICAgICAgICAgICAgIC5zdHlsZShcInRleHQtYW5jaG9yXCIsIFwic3RhcnRcIilcbiAgICAgICAgICAgICAgICAuc3R5bGUoXCJmb250LXNpemVcIiwgMTApO1xuICAgICAgICAgICAgO1xuICAgICAgICB9XG5cbiAgICAgICAgZy5hcHBlbmQoXCJnXCIpXG4gICAgICAgICAgICAvLyAuYXR0cihcImNvbG9yXCIsIFwiZ3JleVwiKVxuICAgICAgICAgICAgLmNhbGwoZDMuYXhpc0xlZnQoeSkudGlja3ModGhpcy50aWNrc2NvdW50KSlcbiAgICAgICAgLy8gdGlja1NpemUoMCwxMCkpO1xuICAgICAgICBsZXQgcmF3ZGF0YSA9IHRoaXMuX2RhdGE7XG5cblxuICAgICAgICAvLyBjYWxsIGZ1bmN0aW9uIHRvIGFsdGVyIGxlZ2VuZHMgaWYgZGlzcGxheWZpZWxkIGNvbmRuIHNhdGlzZnlcbiAgICAgICAgdGhpcy5hbHRlckxlZ2VuZCgpO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBnLCB4LCB5LCBoZWlnaHQsIHdpZHRoLCByYXdkYXRhXG4gICAgICAgIH1cbiAgICAgICAgLy8gXG5cbiAgICB9XG5cblxuICAgIHByb3RlY3RlZCBwbG90U2NhbGUoZzogYW55LCB4OiBhbnksIHk6IGFueSwgaGVpZ2h0OiBhbnksIHdpZHRoOiBhbnkpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMudlNjYWxlKSB7XG4gICAgICAgICAgICBnLmFwcGVuZCgnZycpXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJjb2xvclwiLCBcImxpZ2h0Z3JleVwiKVxuICAgICAgICAgICAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKDAsJyArIGhlaWdodCArICcpJylcbiAgICAgICAgICAgICAgICAuY2FsbChkMy5heGlzQm90dG9tKHgpLlxuICAgICAgICAgICAgICAgICAgICB0aWNrU2l6ZSgtdGhpcy53aWR0aCkudGlja0Zvcm1hdCgnJylcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLmhTY2FsZSkge1xuICAgICAgICAgICAgZy5hcHBlbmQoJ2cnKVxuICAgICAgICAgICAgICAgIC5hdHRyKFwiY29sb3JcIiwgXCJsaWdodGdyZXlcIilcbiAgICAgICAgICAgICAgICAuY2FsbChkMy5heGlzTGVmdCh5KS50aWNrcyh0aGlzLnRpY2tzY291bnQpXG4gICAgICAgICAgICAgICAgICAgIC50aWNrU2l6ZSgtd2lkdGgpLnRpY2tGb3JtYXQoJycpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGxlZ2VuZENsaWNrKG5vZGU6IGFueSkge1xuXG4gICAgICAgIC8vIGNvbnN0IGxlZ2VuZE5vZGUgPSBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KG5vZGUpKTtcbiAgICAgICAgLy8gZGVsZXRlIGxlZ2VuZE5vZGUuY29sb3I7XG4gICAgICAgIC8vIGxlZ2VuZE5vZGUuZGF0YS5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAvLyAgICAgZGVsZXRlIGVsZW1lbnQubGVnZW5kO1xuICAgICAgICAvLyB9KTtcblxuICAgICAgICBsZXQgb2JqID0ge307XG4gICAgICAgIG9ialtcImxhYmVsXCJdID0gbm9kZS5sYWJlbDtcbiAgICAgICAgbGV0IGRhdGEgPSBbXTtcbiAgICAgICAgbm9kZS5kYXRhLmZvckVhY2goZWxlbWVudCA9PiB7XG4gICAgICAgICAgICBsZXQgb2JqZWN0ID0ge307XG5cbiAgICAgICAgICAgIG9iamVjdFtlbGVtZW50LmxlZ2VuZF0gPSBlbGVtZW50LnZhbHVlO1xuICAgICAgICAgICAgb2JqZWN0W3RoaXMueGF4aXNuYW1lXSA9IGVsZW1lbnQubGFiZWw7XG4gICAgICAgICAgICAvLyAgIG9iamVjdFtlbGVtZW50LmxhYmVsXSA9IGVsZW1lbnQudmFsdWU7XG4gICAgICAgICAgICBkYXRhLnB1c2gob2JqZWN0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIG9ialtcImRhdGFcIl0gPSBkYXRhO1xuICAgICAgICB0aGlzLm9uTGVnZW5kQ2xpY2suZW1pdChvYmopO1xuXG4gICAgICAgIC8vIHRoaXMub25MZWdlbmRDbGljay5lbWl0KGxlZ2VuZE5vZGUpO1xuICAgIH1cblxuXG4gICAgYWx0ZXJMZWdlbmQoKSB7XG4gICAgICAgIHRoaXMubGluZWxlZ2VuZHMgPSBbXTtcbiAgICAgICAgaWYgKHRoaXMuZGlzcGxheWZpZWxkKSB7XG5cbiAgICAgICAgICAgIHRoaXMubGVnZW5kcy5mb3JFYWNoKGVsZW1lbnQgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlbGVtZW50LmxhYmVsICE9PSB0aGlzLmRpc3BsYXlmaWVsZCkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmxpbmVsZWdlbmRzLnB1c2goZWxlbWVudCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmxpbmVsZWdlbmRzID0gdGhpcy5sZWdlbmRzO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY2FsbFhheGlzVG9vbHRpcCh0b29sdGlwZGF0YTogYW55KSB7XG4gICAgICAgIHZhciBvYmogPSB7fTtcbiAgICAgICAgb2JqWyd4LWF4aXMnXSA9IHRvb2x0aXBkYXRhO1xuICAgICAgICByZXR1cm4gdGhpcy50b29sVGlwRm9yQmFyKG9iaik7XG4gICAgfVxufSJdfQ==